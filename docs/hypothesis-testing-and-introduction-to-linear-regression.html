<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Hypothesis testing and introduction to linear regression | Module I BIOSCI220, University of Auckland</title>
  <meta name="description" content="3 Hypothesis testing and introduction to linear regression | Module I BIOSCI220, University of Auckland" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Hypothesis testing and introduction to linear regression | Module I BIOSCI220, University of Auckland" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Hypothesis testing and introduction to linear regression | Module I BIOSCI220, University of Auckland" />
  
  
  

<meta name="author" content="Charlotte Jones-Todd" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-exploration-and-visualization.html"/>
<link rel="next" href="statistical-inference.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#course-overview-biosci220"><i class="fa fa-check"></i><b>0.1</b> Course Overview: BIOSCI220</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#module-1-key-topics"><i class="fa fa-check"></i><b>0.2</b> Module 1: Key Topics</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#timetable-assessment-modules-i-ii-and-iii"><i class="fa fa-check"></i><b>0.3</b> Timetable &amp; Assessment (Modules I, II, and III)</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> <code>R</code> and <code>RStudio</code></a><ul>
<li class="chapter" data-level="1.1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#introduction-to-r-and-rstudio"><i class="fa fa-check"></i><b>1.2</b> Introduction to <code>R</code> and <code>RStudio</code></a><ul>
<li class="chapter" data-level="1.2.1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#why"><i class="fa fa-check"></i><b>1.2.1</b> Why?</a></li>
<li class="chapter" data-level="1.2.2" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>1.2.2</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.2.3" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#getting-started"><i class="fa fa-check"></i><b>1.2.3</b> Getting started</a></li>
<li class="chapter" data-level="1.2.4" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#r-scripts-a-.r-file"><i class="fa fa-check"></i><b>1.2.4</b> R <em>Script</em>s (a <code>.r</code> file)</a></li>
<li class="chapter" data-level="1.2.5" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#writing-comments"><i class="fa fa-check"></i><b>1.2.5</b> Writing <em>Comments</em></a></li>
<li class="chapter" data-level="1.2.6" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#data-types"><i class="fa fa-check"></i><b>1.2.6</b> Data types</a></li>
<li class="chapter" data-level="1.2.7" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#creating-objects"><i class="fa fa-check"></i><b>1.2.7</b> Creating <em>Objects</em></a></li>
<li class="chapter" data-level="1.2.8" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#r-functions"><i class="fa fa-check"></i><b>1.2.8</b> <code>R</code> functions</a></li>
<li class="chapter" data-level="1.2.9" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#r-packages"><i class="fa fa-check"></i><b>1.2.9</b> <code>R</code> packages</a></li>
<li class="chapter" data-level="1.2.10" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#r-errors"><i class="fa fa-check"></i><b>1.2.10</b> <code>R</code> Errors</a></li>
<li class="chapter" data-level="1.2.11" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#working-directories"><i class="fa fa-check"></i><b>1.2.11</b> Working directories</a></li>
<li class="chapter" data-level="1.2.12" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#getting-help"><i class="fa fa-check"></i><b>1.2.12</b> Getting help</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#exploratory-data-analysis-eda"><i class="fa fa-check"></i><b>1.3</b> Exploratory Data Analysis (EDA)</a><ul>
<li class="chapter" data-level="1.3.1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#reading-in-data-from-a-.csv-file"><i class="fa fa-check"></i><b>1.3.1</b> Reading in data from a <code>.csv</code> file</a></li>
<li class="chapter" data-level="1.3.2" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#using-functions-to-explore-the-data"><i class="fa fa-check"></i><b>1.3.2</b> Using functions to explore the data</a></li>
<li class="chapter" data-level="1.3.3" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#basic-plotting-for-your-own-purposes"><i class="fa fa-check"></i><b>1.3.3</b> Basic plotting (for your own purposes)</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#other-resources-optional-but-recommended"><i class="fa fa-check"></i><b>1.4</b> Other resources: optional but recommended</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html"><i class="fa fa-check"></i><b>2</b> Data exploration and visualization</a><ul>
<li class="chapter" data-level="2.1" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#learning-objectives-1"><i class="fa fa-check"></i><b>2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="2.2" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#data-sovereignty"><i class="fa fa-check"></i><b>2.2</b> Data sovereignty</a><ul>
<li class="chapter" data-level="2.2.1" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#māori-data-sovereignty-principles"><i class="fa fa-check"></i><b>2.2.1</b> Māori Data Sovereignty principles</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#data-wrangling-and-manipulation"><i class="fa fa-check"></i><b>2.3</b> Data wrangling and manipulation</a><ul>
<li class="chapter" data-level="2.3.1" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#introuducing-the-palmer-penguins"><i class="fa fa-check"></i><b>2.3.1</b> Introuducing the <span>Palmer penguins</span></a></li>
<li class="chapter" data-level="2.3.2" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#common-dataframe-manipulations-in-the-tidyverse-using-dplyr-and-tidyr"><i class="fa fa-check"></i><b>2.3.2</b> Common dataframe manipulations in the <code>tidyverse</code>, using <code>dplyr</code> and <code>tidyr</code></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#data-viz"><i class="fa fa-check"></i><b>2.4</b> Data Viz</a><ul>
<li class="chapter" data-level="2.4.1" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#exploratory-and-explanatory-plots"><i class="fa fa-check"></i><b>2.4.1</b> Exploratory and explanatory plots</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#ten-simple-rules-for-better-figures"><i class="fa fa-check"></i><b>2.4.2</b> <span>Ten Simple Rules for Better Figures</span></a></li>
<li class="chapter" data-level="2.4.3" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#introducing-ggplot2"><i class="fa fa-check"></i><b>2.4.3</b> Introducing <code>ggplot2</code></a></li>
<li class="chapter" data-level="2.4.4" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#what-do-we-think-about-when-we-look-at-plots-a-taster"><i class="fa fa-check"></i><b>2.4.4</b> What do we think about when we look at plots (<em>a taster</em>)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#other-resources-optional-but-recommended-1"><i class="fa fa-check"></i><b>2.5</b> Other resources: optional but recommended</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Hypothesis testing and introduction to linear regression</a><ul>
<li class="chapter" data-level="3.1" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#learning-objectives-2"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#introdcution-to-hypothesis-testing"><i class="fa fa-check"></i><b>3.2</b> Introdcution to hypothesis testing</a><ul>
<li class="chapter" data-level="3.2.1" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#one-sample-t-test"><i class="fa fa-check"></i><b>3.2.1</b> One-Sample t-test</a></li>
<li class="chapter" data-level="3.2.2" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#differences-between-two-means"><i class="fa fa-check"></i><b>3.2.2</b> Differences between two means</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#correctly-interpreting-p-values"><i class="fa fa-check"></i><b>3.3</b> 😱 Correctly interpreting p-values 😱</a><ul>
<li class="chapter" data-level="3.3.1" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#the-asa-statement-on-p-values-context-process-and-purpose"><i class="fa fa-check"></i><b>3.3.1</b> <span>The ASA Statement on p-Values: Context, Process, and Purpose</span></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#power-significance-and-multiple-comparisons"><i class="fa fa-check"></i><b>3.4</b> Power, Significance, and multiple comparisons</a></li>
<li class="chapter" data-level="3.5" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#randomization-test"><i class="fa fa-check"></i><b>3.5</b> Randomization test</a></li>
<li class="chapter" data-level="3.6" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#one-way-anova-using-lm"><i class="fa fa-check"></i><b>3.6</b> One way ANOVA using <code>lm()</code></a></li>
<li class="chapter" data-level="3.7" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#model-diagnostics"><i class="fa fa-check"></i><b>3.7</b> Model diagnostics</a></li>
<li class="chapter" data-level="3.8" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#other-resources-optional-but-recommended-2"><i class="fa fa-check"></i><b>3.8</b> Other resources: optional but recommended</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>4</b> Statistical Inference</a><ul>
<li class="chapter" data-level="4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#learning-objectives-3"><i class="fa fa-check"></i><b>4.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#regression"><i class="fa fa-check"></i><b>4.2</b> Regression</a><ul>
<li class="chapter" data-level="4.2.1" data-path="statistical-inference.html"><a href="statistical-inference.html#some-mathematical-notation"><i class="fa fa-check"></i><b>4.2.1</b> Some mathematical notation</a></li>
<li class="chapter" data-level="4.2.2" data-path="statistical-inference.html"><a href="statistical-inference.html#modeling-bill-depth"><i class="fa fa-check"></i><b>4.2.2</b> Modeling Bill Depth</a></li>
<li class="chapter" data-level="4.2.3" data-path="statistical-inference.html"><a href="statistical-inference.html#single-continuous-variable"><i class="fa fa-check"></i><b>4.2.3</b> Single continuous variable</a></li>
<li class="chapter" data-level="4.2.4" data-path="statistical-inference.html"><a href="statistical-inference.html#factor-and-a-continous-variable"><i class="fa fa-check"></i><b>4.2.4</b> Factor and a continous variable</a></li>
<li class="chapter" data-level="4.2.5" data-path="statistical-inference.html"><a href="statistical-inference.html#interactions"><i class="fa fa-check"></i><b>4.2.5</b> Interactions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="statistical-inference.html"><a href="statistical-inference.html#model-comparison-selection-and-checking-again"><i class="fa fa-check"></i><b>4.3</b> Model, comparison, selection, and checking (again)</a><ul>
<li class="chapter" data-level="4.3.1" data-path="statistical-inference.html"><a href="statistical-inference.html#model-comparison-and-selection"><i class="fa fa-check"></i><b>4.3.1</b> Model comparison and selection</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="statistical-inference.html"><a href="statistical-inference.html#point-predictions-and-confidence-intervals"><i class="fa fa-check"></i><b>4.4</b> Point predictions and confidence intervals</a><ul>
<li class="chapter" data-level="4.4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#confidence-intervals-for-parameters"><i class="fa fa-check"></i><b>4.4.1</b> Confidence intervals for parameters</a></li>
<li class="chapter" data-level="4.4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#point-prediction"><i class="fa fa-check"></i><b>4.4.2</b> Point prediction</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="statistical-inference.html"><a href="statistical-inference.html#tldr-lm"><i class="fa fa-check"></i><b>4.5</b> TL;DR <code>lm()</code></a><ul>
<li class="chapter" data-level="4.5.1" data-path="statistical-inference.html"><a href="statistical-inference.html#model-formula-syntax"><i class="fa fa-check"></i><b>4.5.1</b> <strong>Model formula</strong> syntax</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="statistical-inference.html"><a href="statistical-inference.html#other-resources-optional-but-recommended-3"><i class="fa fa-check"></i><b>4.6</b> Other resources: optional but recommended</a></li>
<li class="chapter" data-level="4.7" data-path="statistical-inference.html"><a href="statistical-inference.html#beyond-linear-models-to-generalised-linear-models-glms-not-examinable"><i class="fa fa-check"></i><b>4.7</b> Beyond Linear Models to Generalised Linear Models (GLMs) (<em>not examinable</em>)</a><ul>
<li class="chapter" data-level="4.7.1" data-path="statistical-inference.html"><a href="statistical-inference.html#counting-animals"><i class="fa fa-check"></i><b>4.7.1</b> Counting animals…</a></li>
<li class="chapter" data-level="4.7.2" data-path="statistical-inference.html"><a href="statistical-inference.html#other-modelling-approaches-not-examinable"><i class="fa fa-check"></i><b>4.7.2</b> Other modelling approaches (not examinable)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html"><i class="fa fa-check"></i><b>5</b> Introduction to the design and analysis of experiments</a><ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#learning-objectives-4"><i class="fa fa-check"></i><b>5.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#key-phrases"><i class="fa fa-check"></i><b>5.2</b> Key phrases</a><ul>
<li class="chapter" data-level="5.2.1" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#example-herbicide"><i class="fa fa-check"></i><b>5.2.1</b> Example: herbicide</a></li>
<li class="chapter" data-level="5.2.2" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#key-questions"><i class="fa fa-check"></i><b>5.2.2</b> Key questions:</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#three-key-principles-of-experimental-design"><i class="fa fa-check"></i><b>5.3</b> Three key principles of experimental design</a><ul>
<li class="chapter" data-level="5.3.1" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#replication"><i class="fa fa-check"></i><b>5.3.1</b> <strong>Replication</strong></a></li>
<li class="chapter" data-level="5.3.2" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#randomization"><i class="fa fa-check"></i><b>5.3.2</b> <strong>Randomization</strong></a></li>
<li class="chapter" data-level="5.3.3" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#blocking"><i class="fa fa-check"></i><b>5.3.3</b> <strong>Blocking</strong></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#other-resources-optional-but-recommended-4"><i class="fa fa-check"></i><b>5.4</b> Other resources: optional but recommended</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Module I BIOSCI220, University of Auckland</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hypothesis-testing-and-introduction-to-linear-regression" class="section level1">
<h1><span class="header-section-number">3</span> Hypothesis testing and introduction to linear regression</h1>
<div id="learning-objectives-2" class="section level2">
<h2><span class="header-section-number">3.1</span> Learning objectives</h2>
<ul>
<li>Formulate a question/hypothesis to investigate based on the given data</li>
<li>Explain and discuss the limitations of statistical linear regression, with a single factor explanatory variable</li>
<li>Interpret and communicate the estimated coefficients of a linear regression model with a single factor explanatory variable to both a statistical and non-statistical audience; discuss and critique model fit</li>
<li>List the aims, write out the appropriate null and alternative hypothesis using statistical notation for, and write <code>R</code> code to carry out a
<ul>
<li>one-sample t-test</li>
<li>two-sample t-test (independent and dependent)</li>
<li>randomization test</li>
<li>one-way Analysis of Variance (ANOVA)</li>
</ul></li>
<li>Correctly interpret and communicate a p-value in terms of the hypotheses test listed above</li>
<li>State in terms of probability statements the meaning of the power and significance level of an hypothesis test</li>
</ul>
</div>
<div id="introdcution-to-hypothesis-testing" class="section level2">
<h2><span class="header-section-number">3.2</span> Introdcution to hypothesis testing</h2>
<p>Using the <code>paua.csv</code> data from CANVAS. The P<span class="math inline">\(\overline{\text{a}}\)</span>ua dataset contains the following variables</p>
<ul>
<li><code>Age</code> of P<span class="math inline">\(\overline{\text{a}}\)</span>ua in years (calculated from counting rings in the cone)</li>
<li><code>Length</code> of P<span class="math inline">\(\overline{\text{a}}\)</span>ua shell in centimeters</li>
<li><code>Species</code> of P<span class="math inline">\(\overline{\text{a}}\)</span>ua: <em>Haliotis iris</em> (typically found in NZ) and
<em>Haliotis australis</em> (less commonly found in NZ)</li>
</ul>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb60-2" title="2">paua &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;paua.csv&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">glimpse</span>(paua)</a></code></pre></div>
<pre><code>## Rows: 60
## Columns: 3
## $ Species &lt;chr&gt; &quot;Haliotis iris&quot;, &quot;Haliotis australis&quot;, &quot;Haliotis australis&quot;, &quot;…
## $ Length  &lt;dbl&gt; 1.80, 5.40, 4.80, 5.75, 5.65, 2.80, 5.90, 3.75, 7.20, 4.25, 6.…
## $ Age     &lt;dbl&gt; 1.497884, 11.877010, 5.416991, 4.497799, 5.500789, 2.500972, 6…</code></pre>
<div id="one-sample-t-test" class="section level3">
<h3><span class="header-section-number">3.2.1</span> One-Sample t-test</h3>
<p>Using a violin plot we can look at the distribution of shell <code>Length</code>. We can calculate the average <code>Length</code> of all shells in our sample</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">paua <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">average_length =</span> <span class="kw">mean</span>(Length))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   average_length
##            &lt;dbl&gt;
## 1           5.19</code></pre>
<p><img src="_main_files/figure-html/vio1-1.png" width="672" /></p>
<p>What about drawing inference? Do we believe that the average length of P<span class="math inline">\(\overline{\text{a}}\)</span>ua shells is, say, 5cm? We know our sample average, but can we make any claims based on this one number?</p>
<p>How do we reflect our uncertainty about the population mean? (<em>remember it’s the population we want to make inference on based on our sample!</em>) Enter the Standard Error of the Mean, <strong>SEM</strong>, <span class="math inline">\(= \frac{\sigma}{\sqrt{n}}\)</span>; where <span class="math inline">\(\sigma = \sqrt{\frac{\Sigma_{i = 1}^n(x_i - \bar{x})^2}{n-1}}\)</span> (<span class="math inline">\(i = 1,...,n\)</span>) is the standard deviation (SD) of the sample, <span class="math inline">\(n\)</span> is the sample size, and <span class="math inline">\(\bar{x}\)</span> is the sample mean.</p>
<p><strong>Calculating <span class="math inline">\(\Sigma_{i = 1}^n(x_i - \bar{x})^2, i = 1,...,n\)</span> by hand</strong>.</p>
<p>It’s the sum squared differences of the distances between the <span class="math inline">\(i^{th}\)</span> observation and the sample mean <span class="math inline">\(\bar{x}\)</span> (denoted <span class="math inline">\(\mu_x\)</span> in the GIF below)</p>
<p><img src="https://raw.githubusercontent.com/cmjt/statbiscuits/master/figs_n_gifs/var.gif" /></p>
<p>So using the example values in the GIF</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="co">## our sample of values</span></a>
<a class="sourceLine" id="cb65-2" title="2">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>)</a>
<a class="sourceLine" id="cb65-3" title="3"><span class="co">## sample mean</span></a>
<a class="sourceLine" id="cb65-4" title="4">sample_mean &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb65-5" title="5">sample_mean</a></code></pre></div>
<pre><code>## [1] 4.333333</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="co">## distance from mean for each value</span></a>
<a class="sourceLine" id="cb67-2" title="2">distance_from_mean &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span>sample_mean</a>
<a class="sourceLine" id="cb67-3" title="3">distance_from_mean</a></code></pre></div>
<pre><code>## [1] -3.3333333 -2.3333333 -1.3333333  0.6666667  1.6666667  4.6666667</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="co">## squared distance from mean for each value</span></a>
<a class="sourceLine" id="cb69-2" title="2">squared_distance_from_mean &lt;-<span class="st"> </span>distance_from_mean<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb69-3" title="3">squared_distance_from_mean</a></code></pre></div>
<pre><code>## [1] 11.1111111  5.4444444  1.7777778  0.4444444  2.7777778 21.7777778</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="co">## sum of the squared distances</span></a>
<a class="sourceLine" id="cb71-2" title="2"><span class="kw">sum</span>(squared_distance_from_mean)</a></code></pre></div>
<pre><code>## [1] 43.33333</code></pre>
<p><strong>Calculating SD and SEM</strong></p>
<p>Now what about the <strong>SD</strong>? Remember it’s the <span class="math inline">\(\sqrt{\frac{\Sigma_{i = 1}^n(x_i - \bar{x})^2}{n-1}}\)</span> so = <span class="math inline">\(\sqrt{\frac{43.3333333}{n-1}}\)</span> = <span class="math inline">\(\sqrt{\frac{43.3333333}{6-1}}\)</span> = <span class="math inline">\(\sqrt{\frac{43.3333333}{5}}\)</span> = 2.9439203.</p>
<p>Or we could just use <code>R</code>’s <code>sd()</code> function</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">sd</span>(x)</a></code></pre></div>
<pre><code>## [1] 2.94392</code></pre>
<p>So the <strong>SEM</strong> is <span class="math inline">\(\frac{\text{SD}}{\sqrt{n}}\)</span> = <span class="math inline">\(\frac{2.9439203}{\sqrt{6}}\)</span></p>
<p>In <code>R</code></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(x))</a></code></pre></div>
<pre><code>## [1] 1.20185</code></pre>
<p>For the <code>paua</code> data we can simply use the in-built functions in <code>R</code> to calculate the SEM</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">sem &lt;-<span class="st"> </span>paua <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Length),</a>
<a class="sourceLine" id="cb77-2" title="2">                   <span class="dt">sem =</span> <span class="kw">sd</span>(Length)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(Length)))</a>
<a class="sourceLine" id="cb77-3" title="3">sem</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##    mean   sem
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  5.19 0.155</code></pre>
<p><strong>Visualising the uncertainty</strong></p>
<p>Recall that the SEM is a measure of uncertainty about the mean. So we can use it to express our uncertainty visually. Typically <span class="math inline">\(\pm\)</span> twice the SEM is the interval used:</p>
<p><img src="_main_files/figure-html/vizun-1.png" width="672" /></p>
<p><strong>Why error bars that are <span class="math inline">\(\pm\)</span> twice the SEM?</strong></p>
<p>This is approximately the 95% confidence interval for the population mean (<em>see lecture</em>)</p>
<p>The exact 95% CI is given by <span class="math inline">\(\bar{x}\)</span> (mean) <span class="math inline">\(\pm\)</span> <span class="math inline">\(t_{df,1 - \alpha/2}\)</span> <span class="math inline">\(\times\)</span> SEM</p>
<ul>
<li>df = degrees of freedom (<em>in this situation</em> df = n - 1)</li>
<li><span class="math inline">\(\alpha\)</span> = level of significance</li>
</ul>
<p>Each mean has its own confidence interval whose width depends on the SEM for that mean</p>
<p>When the df (<em>more on these later</em>) are large (e.g. 30 or greater) and <span class="math inline">\(\alpha\)</span> = 0.05 <span class="math inline">\(t_{df,1 - \alpha/2}\)</span> = <span class="math inline">\(t_{large,0.975}\)</span> <span class="math inline">\(\approx\)</span> 2. Hence, the 95% confidence interval for the population mean is approximately <span class="math inline">\(\bar{x}\)</span> (mean) <span class="math inline">\(\pm\)</span> 2 <span class="math inline">\(\times\)</span> SEM</p>
<p><strong>Back to our hypothesis test</strong></p>
<p><strong>Question:</strong> Do we believe that the average length of P<span class="math inline">\(\overline{\text{a}}\)</span>ua shells is 5cm?</p>
<p><strong>Formalizing into a hypothesis test:</strong></p>
<ul>
<li><em>Null hypothesis</em>: On average P<span class="math inline">\(\overline{\text{a}}\)</span>ua shells are 5cm long</li>
<li><em>Alternative hypothesis</em>: On average P<span class="math inline">\(\overline{\text{a}}\)</span>ua shells are <strong>not</strong> 5cm long</li>
<li><em>Notationally</em>: <span class="math inline">\(H_0: \mu = 5\)</span> vs <span class="math inline">\(H_1: \mu \neq 5\)</span> (<em><span class="math inline">\(\mu\)</span> is the proposed mean</em>)</li>
</ul>
<p><strong>Calculating a statistic</strong> (<em>we use a t-statistic</em>)</p>
<p>t-statistic <span class="math inline">\(= \frac{\bar{x}- \mu}{\text{SEM}}\)</span> = <span class="math inline">\(\frac{5.1925 - 5}{0.155351}\)</span> = 1.239</p>
<ul>
<li><p><span class="math inline">\(\bar{x}\)</span> is the sample mean</p></li>
<li><p><span class="math inline">\(\mu\)</span> is the theoretical value (<em>proposed mean</em>)</p></li>
</ul>
<p><strong>The corresponding p-value</strong></p>
<p>Q: <em>What is a p-Value?</em></p>
<p>A: Informally, a p-value is the probability under a specified statistical model that a statistical summary of the data would be equal to or more extreme than its observed value</p>
<p>So in this case it’s the probability, under the null hypothesis (<span class="math inline">\(\mu = 5\)</span>), that we would observe a statistic as least as extreme as we did.</p>
<p>Under our null hypothesis the distribution of the t-statistic is as below. The one calculated from our hypothesis test was 1.2391. Now, remember that our alternative hypotheses was <span class="math inline">\(H_1: \mu \neq 5\)</span> so we have to consider both sides of the inequality; hence, anything as least as extreme is either <span class="math inline">\(&gt; 1.2391\)</span> or <span class="math inline">\(&lt; -1.2391\)</span> to our observed statistic (vertical lines). Anything as least as extreme is therefore given by the grey shaded areas.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>We can calculate the p-value using the <code>pt()</code> function (where <code>q</code> is our calculated t-statistic, and <code>df</code> are the degrees of freedom from above):</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(<span class="dt">q  =</span> <span class="fl">1.2391</span>,<span class="dt">df =</span> <span class="dv">59</span>))</a></code></pre></div>
<pre><code>## [1] 0.2202152</code></pre>
<p>Or we could do all of the above in one step using <code>R</code></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="kw">t.test</span>(paua<span class="op">$</span>Length, <span class="dt">mu =</span> <span class="dv">5</span> )</a></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  paua$Length
## t = 1.2391, df = 59, p-value = 0.2202
## alternative hypothesis: true mean is not equal to 5
## 95 percent confidence interval:
##  4.881643 5.503357
## sample estimates:
## mean of x 
##    5.1925</code></pre>
<p>Recall, that the p-value gives the probability that under our null hypothesis we observe anything as least as extreme as what we did (hence the <span class="math inline">\(\times 2\)</span>, think of the grey shaded area in the graph). This probability is <span class="math inline">\(\sim\)</span> 22%. Do you think what we’ve observed is likely under the null hypothesis?</p>
<p>Does this plot help? The proposed mean is shown by the red horizontal line; the dashed line shows the sample mean and the dotted lines <span class="math inline">\(\pm\)</span> the SEM.</p>
<p><img src="_main_files/figure-html/vizunmu-1.png" width="672" /></p>
</div>
<div id="differences-between-two-means" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Differences between two means</h3>
<p><img src="_main_files/figure-html/vio-1.png" width="672" /></p>
<p><strong>Calculating the differences between species means:</strong></p>
<p><em>Haliotis australis</em> average - <em>Haliotis iris</em> average = <span class="math inline">\(\mu_{\text{Haliotis australis}} - \mu_{\text{Haliotis iris}}\)</span> = 5.767 - 4.81 = 0.957. Doesn’t really tell us much…</p>
<p>As above the average values are all well and good, but what about <strong>variation?</strong> Recall the SEM from the one-sample t-test? The same idea holds here, although the calculation is a little bit more complicated (as we have to think about the number of observations in each group). But from the two group SEMs we can calculate the Standard Error of the Difference between two means, <strong>SED</strong>.</p>
<div id="independent-samples-t-test-with-lm-and-t.test" class="section level4">
<h4><span class="header-section-number">3.2.2.1</span> Independent samples t-test with <code>lm()</code> and <code>t.test()</code></h4>
<p><strong>Question:</strong> Do we believe that on average the length of P<span class="math inline">\(\overline{\text{a}}\)</span>ua shells are equal between species</p>
<p><strong>Formalizing into a hypothesis test:</strong></p>
<ul>
<li><strong>Null hypothesis</strong>: On average the species’ shells are the same length</li>
<li><strong>Alternative hypothesis</strong>: they aren’t!</li>
<li><strong>Notationally</strong>: <span class="math inline">\(H_0: \mu_{\text{Haliotis iris}} - \mu_{\text{Haliotis australis}} = 0\)</span> vs <span class="math inline">\(H_1: \mu_{\text{Haliotis iris}} \neq \mu_{\text{Haliotis australis}}\)</span></li>
</ul>
<pre><code>+ $\mu_{j}$ is the average length for species $j =$ (*Haliotis iris*, *Haliotis australis*), </code></pre>
<p><strong>Calculate the test statistic:</strong> t-statistic = <span class="math inline">\(\frac{\bar{x}_{\text{difference}} - \mu}{\text{SED}}\)</span> = <span class="math inline">\(\frac{\bar{x}_{\text{difference}} - 0}{\text{SED}}\)</span></p>
<ul>
<li>where <span class="math inline">\(\bar{x}_{\text{difference}}\)</span> is the differences between the species` averages.</li>
</ul>
<p>Calculations area a little bit more tricky here so let’s use <code>R</code>. We have two options (both answer our question):</p>
<p><strong>Option 1.</strong> using <code>t.test()</code></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1">test &lt;-<span class="st"> </span><span class="kw">t.test</span>(Length <span class="op">~</span><span class="st"> </span>Species, <span class="dt">data =</span> paua)</a>
<a class="sourceLine" id="cb84-2" title="2"><span class="co">## printing out the result</span></a>
<a class="sourceLine" id="cb84-3" title="3">test</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Length by Species
## t = 3.5404, df = 57.955, p-value = 0.0007957
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.4158802 1.4980086
## sample estimates:
## mean in group Haliotis australis      mean in group Haliotis iris 
##                         5.766667                         4.809722</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">test<span class="op">$</span>p.value</a></code></pre></div>
<pre><code>## [1] 0.0007956853</code></pre>
<p>Listed are the t-statistic, <code>t</code> = 3.5403636 and the p-value, <code>p-value</code> = 7.956853310^{-4} for the hypothesis test outlined above. What would you conclude?</p>
<p><strong>Option 2.</strong> using <code>lm()</code></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">t.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(Length <span class="op">~</span><span class="st"> </span>Species, <span class="dt">data =</span> paua)</a>
<a class="sourceLine" id="cb88-2" title="2"><span class="co">##extracting the estimated parameters</span></a>
<a class="sourceLine" id="cb88-3" title="3"><span class="kw">summary</span>(t.lm)<span class="op">$</span>coef</a></code></pre></div>
<pre><code>##                        Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)           5.7666667  0.2278199 25.312396 4.911173e-33
## SpeciesHaliotis iris -0.9569444  0.2941142 -3.253649 1.902460e-03</code></pre>
<p>So, what are the printed values?</p>
<p><strong>Inference</strong></p>
<p>(Intercept) = the <em>baseline</em> = <span class="math inline">\(\mu_\text{Haliotis australis}\)</span> = 5.7666667</p>
<p>SE of (Intercept) = SE of <span class="math inline">\(\mu_\text{Haliotis australis}\)</span> = SEM = 0.2278199</p>
<p><span class="math inline">\(\text{SpeciesHaliotis iris}\)</span> = <span class="math inline">\(\mu_\text{Haliotis iris}\)</span> – <span class="math inline">\(\mu_\text{Haliotis australis}\)</span> = -0.9569444</p>
<p>SE of <span class="math inline">\(\text{SpeciesHaliotis iris}\)</span> = SE of (<span class="math inline">\(\mu_\text{Haliotis iris}\)</span> – <span class="math inline">\(\mu_\text{Haliotis australis}\)</span> ) = SED = 0.2941142</p>
<p><strong>Hypotheses being tested</strong></p>
<ul>
<li><p>The <code>t value</code> and <code>Pr (&gt;|t|)</code> are the t - and p-value for testing the null hypotheses:</p>
<ol style="list-style-type: decimal">
<li>Mean abundance is zero for <em>Haliotis australis</em> (not interested in this really)</li>
<li>No difference between the population means of <em>Haliotis australis</em> and <em>Haliotis iris</em></li>
</ol></li>
</ul>
<p><img src="_main_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="co">## changing the baseline</span></a>
<a class="sourceLine" id="cb90-2" title="2"><span class="co">## it&#39;s the ordering that makes the difference</span></a>
<a class="sourceLine" id="cb90-3" title="3">paua_rl &lt;-<span class="st"> </span>paua <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Species =</span> <span class="kw">fct_relevel</span>(Species, <span class="st">&quot;Haliotis iris&quot;</span>, <span class="st">&quot;Haliotis australis&quot;</span>))</a>
<a class="sourceLine" id="cb90-4" title="4"></a>
<a class="sourceLine" id="cb90-5" title="5">c.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(Age <span class="op">~</span><span class="st"> </span>Species, <span class="dt">data =</span> paua_rl)</a>
<a class="sourceLine" id="cb90-6" title="6"><span class="kw">summary</span>(c.lm)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Age ~ Species, data = paua_rl)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.9050 -0.9227 -0.0752  0.5973  5.5988 
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                 4.4029     0.2659  16.560  &lt; 2e-16 ***
## SpeciesHaliotis australis   3.1431     0.4204   7.477 4.63e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.595 on 58 degrees of freedom
## Multiple R-squared:  0.4908, Adjusted R-squared:  0.482 
## F-statistic:  55.9 on 1 and 58 DF,  p-value: 4.631e-10</code></pre>
<p><strong>Inference</strong></p>
<p>(Intercept) = the <em>baseline</em> = <span class="math inline">\(\mu_\text{Haliotis iris}\)</span> = 4.4028662</p>
<p>SE of (Intercept) = SE of <span class="math inline">\(\mu_\text{Haliotis iris}\)</span> = SEM = 0.26587</p>
<p><span class="math inline">\(\text{SpeciesHaliotis australis}\)</span> = <span class="math inline">\(\mu_\text{Haliotis australis}\)</span> – <span class="math inline">\(\mu_\text{Haliotis iris}\)</span> = 3.1430733</p>
<p>SE of <span class="math inline">\(\text{SpeciesHaliotis australis}\)</span> = SE of (<span class="math inline">\(\mu_\text{Haliotis australis}\)</span> – <span class="math inline">\(\mu_\text{Haliotis iris}\)</span> ) = SED = 0.4203774</p>
<p><strong>Hypotheses being tested</strong></p>
<ul>
<li><p>The <code>t value</code> and <code>Pr (&gt;|t|)</code> are the t - and p-value for testing the null hypotheses:</p>
<ol style="list-style-type: decimal">
<li>Mean abundance is zero for <em>Haliotis iris</em> (not interested in this really)</li>
<li>No difference between the population means of <em>Haliotis iris</em> and <em>Haliotis australis</em></li>
</ol></li>
</ul>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="correctly-interpreting-p-values" class="section level2">
<h2><span class="header-section-number">3.3</span> 😱 Correctly interpreting p-values 😱</h2>
<blockquote>
“Good statistical practice, as an essential component of good scientific practice,
emphasizes principles of good study design and conduct, a variety of numerical
and graphical summaries of data, understanding of the phenomenon under study,
interpretation of results in context, complete reporting and proper
logical and quantitative understanding of what data summaries mean.
No single index should substitute for scientific reasoning.”
<footer>
— ASA Statement on p-Values
</footer>
</blockquote>
<p><strong>What is a p-Value?</strong></p>
<p>Informally, a p-value is the probability under a specified statistical model that a statistical summary of the data (e.g., the sample mean difference between two compared groups) would be equal to or more extreme than its observed value.</p>
<p><strong>Note</strong></p>
<ul>
<li><p><strong>p-values</strong> can indicate how incompatible the data are with a specified statistical model</p></li>
<li><p>p-values <strong>do not</strong> measure the probability that the studied hypothesis is true, or the probability that the data were produced by random chance alone</p></li>
<li><p>scientific conclusions and business or policy decisions <strong>should not</strong> be based only on whether a p-value passes a specific threshold</p></li>
<li><p>proper inference requires <strong>full</strong> reporting and transparency</p></li>
<li><p>p-value, or statistical significance, does <strong>not</strong> measure the size of an effect or the importance of a result</p></li>
<li><p>by itself, a p-value does <strong>not</strong> provide a good measure of evidence regarding a model or hypothesis</p></li>
</ul>
<div id="the-asa-statement-on-p-values-context-process-and-purpose" class="section level3">
<h3><span class="header-section-number">3.3.1</span> <a href="https://www.tandfonline.com/doi/full/10.1080/00031305.2016.1154108">The ASA Statement on p-Values: Context, Process, and Purpose</a></h3>
<p><strong>Q:</strong> Why do so many colleges and grad schools teach <em>p-val</em>=0.05?</p>
<p><strong>A:</strong> Because that’s still what the scientific community and journal editors use. 😱 <strong>BUT IT SHOULDN’T BE</strong> 😱</p>
<p><strong>Q:</strong> Why do so many people still use <em>p-val</em>=0.05?</p>
<p><strong>A:</strong> Because that’s what they were taught in college or grad school. 😱<strong>BUT THEY SHOULDN’T BE</strong>😱</p>
<p>There are <strong>many</strong> different schools of thought about how a p-value should be interpreted.</p>
<p>Most people agree that the p-value is a useful measure of the strength of evidence against the null hypothesis. The smaller the p-value, the stronger the evidence against <span class="math inline">\(H_0\)</span>.</p>
<p>Some people go further and use an accept/reject framework. Under this framework, the null hypothesis <span class="math inline">\(H_0\)</span> should be rejected if the p-value is less than 0.05 (say), and accepted if the p-value is greater than 0.05.</p>
<p>In this course we mostly use the strength of evidence interpretation.: The p-value measures how far out our observation lies in the tails of the distribution specified by <span class="math inline">\(H_0\)</span>.</p>
<p>Substantial evidence of a difference, <strong>not</strong> Evidence of a substantial difference.</p>
</div>
</div>
<div id="power-significance-and-multiple-comparisons" class="section level2">
<h2><span class="header-section-number">3.4</span> Power, Significance, and multiple comparisons</h2>
<p>Recall, we have two competing hypotheses (claims) relating to the <strong>true</strong> vale of some population characteristic (e.g., the population mean, denoted <span class="math inline">\(\mu\)</span>):</p>
<p><strong>Some terminology</strong></p>
<p><strong>Type I</strong> error (false positive): declare a difference (i.e., reject <span class="math inline">\(H_0\)</span>) when there is no difference (i.e. <span class="math inline">\(H_0\)</span> is true). Risk of the Type I error is determined by the <strong>level of significance</strong> (which we set!) (i.e., <span class="math inline">\(\alpha =\text{ P(Type I error)} = \text{P(false positive)}\)</span>.</p>
<div class="figure">
<img src="https://github.com/allisonhorst/stats-illustrations/blob/master/other-stats-artwork/type_1_errors.png?raw=true" alt="Artwork by @allison_horst" />
<p class="caption">Artwork by <span class="citation">@allison_horst</span></p>
</div>
<p><strong>Type II</strong> error (false negative): difference not declared (i.e., <span class="math inline">\(H_0\)</span> not rejected) when there is a difference (i.e., <span class="math inline">\(H_0\)</span> is false). Let <span class="math inline">\(\beta =\)</span> P(do not reject <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_0\)</span> is false); so, <span class="math inline">\(1-\beta\)</span> = P(reject <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_0\)</span> is false) = P(a true positive), which is the statistical <strong>power</strong> of the test.</p>
<div class="figure">
<img src="https://github.com/allisonhorst/stats-illustrations/blob/master/other-stats-artwork/type_2_errors.png?raw=true" alt="Artwork by @allison_horst" />
<p class="caption">Artwork by <span class="citation">@allison_horst</span></p>
</div>
<p><strong>Significance level</strong> = probability of a Type I error = probability of finding an effect that is not there (false positive).</p>
<p><strong>Power</strong>: the probability that the test correctly rejects the null hypothesis when the
alternative hypothesis is true. probability of finding an effect that is there = 1 - probability of a <strong>Type II</strong> error (false negative).</p>
<p>Reducing the chance of a <strong>Type I</strong> error increases the chance of a <strong>Type II</strong> error. They are inversely related. <strong>Type II</strong> error rate is determined by a combination of the following.</p>
<ul>
<li><strong>Effect size</strong> (size of difference, of biological significance) between the true population parameters</li>
<li>Experimental error variance</li>
<li><strong>Sample size</strong></li>
<li>Choice of <strong>Type I</strong> error rate (<span class="math inline">\(\alpha\)</span>)</li>
</ul>
<p>Each time we carry out a hypothesis test the probability we get a false positive result (<strong>Type I</strong> error) is given by <span class="math inline">\(\alpha\)</span> (the <strong>level of significance</strong> we choose).</p>
<p>When we have <strong>multiple comparisons</strong> to make we should then control the <strong>Type I</strong> error rate across the entire <em>family</em> of tests under consideration, i.e., control the <strong>Family-Wise Error Rate (FWER)</strong>; this ensures that the risk of making at least one <strong>Type I</strong> error among the family of comparisons in the experiment is <span class="math inline">\(\alpha\)</span>.</p>
</div>
<div id="randomization-test" class="section level2">
<h2><span class="header-section-number">3.5</span> Randomization test</h2>
<p>The basic approach to randomization tests is straightforward:</p>
<ol style="list-style-type: decimal">
<li>Decide on a metric to measure the effect in question (e.g., differences between group means)</li>
<li>Calculate that test statistic on the observed data. Note this metric can be <strong>anything</strong> you wish</li>
<li>For chosen number of times (i.e., <code>nreps</code> below)
<ul>
<li>Shuffle the data labels</li>
<li>Calculate the test statistic for the reshuffled data and retain</li>
</ul></li>
<li>Calculate the proportion of times your reshuffled statistics equal or exceed the observed
<ul>
<li>typically here we use the absolute values as we’d be carrying out a <strong>two-tailed</strong> test (or we could double the p-value)</li>
<li>this is the probability of such an extreme result under the null</li>
</ul></li>
<li><strong>State</strong> the strength of evidence against the null on the basis of this <strong>probability</strong>.</li>
</ol>
<p><strong>Randomization Test on Two Independent Samples</strong></p>
<p>Do average lengths differ between Species?</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">means &lt;-<span class="st"> </span>paua <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">means =</span> <span class="kw">mean</span>(Length))</a>
<a class="sourceLine" id="cb92-2" title="2"><span class="kw">ggplot</span>(paua,<span class="kw">aes</span>(<span class="dt">x =</span> Species, <span class="dt">y =</span> Length)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-3" title="3"><span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb92-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-5" title="5"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Length (cms)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-6" title="6"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb92-7" title="7"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> means, <span class="kw">aes</span>(<span class="dt">x =</span> Species, <span class="dt">y =</span> means, <span class="dt">color =</span> Species), <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-8" title="8"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">data =</span> means, <span class="kw">aes</span>(<span class="dt">yintercept =</span> means, <span class="dt">color =</span> Species), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-9" title="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-10" title="10"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> means, <span class="kw">aes</span>(<span class="dt">x =</span> Species, <span class="dt">y =</span> means <span class="op">+</span><span class="st"> </span><span class="fl">0.3</span>, <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;Species averege = &quot;</span>,<span class="kw">round</span>(means,<span class="dv">3</span>)), <span class="dt">color =</span> Species))</a></code></pre></div>
<p><img src="_main_files/figure-html/violen-1.png" width="672" /></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="kw">ggplot</span>(paua,<span class="kw">aes</span>(<span class="dt">x =</span> Length, <span class="dt">fill =</span> Species)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb93-2" title="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-3" title="3"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Length (cms)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-4" title="4"><span class="st">  </span><span class="kw">theme_classic</span>()</a></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/violen-2.png" width="672" /></p>
<p>But because the data are skewed and we’ve likely got non-constant variances we may be better off adopting a randomization test, rather than a parametric t-test</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="co">## observed differences in means</span></a>
<a class="sourceLine" id="cb95-2" title="2">diff_in_means &lt;-<span class="st"> </span>(paua <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Length)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">diff =</span> <span class="kw">diff</span>(mean)))<span class="op">$</span>diff</a>
<a class="sourceLine" id="cb95-3" title="3">diff_in_means</a></code></pre></div>
<pre><code>## [1] -0.9569444</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="co">## Number of times I want to randomise</span></a>
<a class="sourceLine" id="cb97-2" title="2">nreps &lt;-<span class="st"> </span><span class="dv">1000</span>   </a>
<a class="sourceLine" id="cb97-3" title="3"><span class="co">## initialize empty array to hold results</span></a>
<a class="sourceLine" id="cb97-4" title="4">randomisation_difference_mean &lt;-<span class="st"> </span><span class="kw">numeric</span>(nreps)</a>
<a class="sourceLine" id="cb97-5" title="5"><span class="kw">set.seed</span>(<span class="dv">1234</span>) <span class="co">## *****Remove this line for actual analyses*****</span></a>
<a class="sourceLine" id="cb97-6" title="6"><span class="co">## This means that each run with produce the same results and</span></a>
<a class="sourceLine" id="cb97-7" title="7"><span class="co">## agree with the printout that I show.</span></a>
<a class="sourceLine" id="cb97-8" title="8"></a>
<a class="sourceLine" id="cb97-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nreps) {</a>
<a class="sourceLine" id="cb97-10" title="10">  <span class="co">## the observations</span></a>
<a class="sourceLine" id="cb97-11" title="11">  data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">value =</span> paua<span class="op">$</span>Length)</a>
<a class="sourceLine" id="cb97-12" title="12">  <span class="co">##  randomise labels</span></a>
<a class="sourceLine" id="cb97-13" title="13">  data<span class="op">$</span>random_labels &lt;-<span class="kw">sample</span>(paua<span class="op">$</span>Species, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb97-14" title="14">  <span class="co">## randomised differences in mean</span></a>
<a class="sourceLine" id="cb97-15" title="15">  randomisation_difference_mean[i] &lt;-<span class="st"> </span>(data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(random_labels) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(value)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">diff =</span> <span class="kw">diff</span>(mean)))<span class="op">$</span>diff</a>
<a class="sourceLine" id="cb97-16" title="16">}</a>
<a class="sourceLine" id="cb97-17" title="17"><span class="co">## results</span></a>
<a class="sourceLine" id="cb97-18" title="18">results &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">randomisation_difference_mean =</span> randomisation_difference_mean)</a></code></pre></div>
<p><strong>Interpreting p-values for a randomisation test</strong></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="co">## How many randomised differences in means are as least as extreme as the one we observed</span></a>
<a class="sourceLine" id="cb98-2" title="2"><span class="co">## absolute value as dealing with two tailed</span></a>
<a class="sourceLine" id="cb98-3" title="3">n_exceed &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">abs</span>(results<span class="op">$</span>randomisation_difference_mean) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(diff_in_means))</a>
<a class="sourceLine" id="cb98-4" title="4">n_exceed</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="co">## proportion</span></a>
<a class="sourceLine" id="cb100-2" title="2">n_exceed<span class="op">/</span>nreps</a></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">ggplot</span>(results, <span class="kw">aes</span>(<span class="dt">x =</span> randomisation_difference_mean)) <span class="op">+</span></a>
<a class="sourceLine" id="cb102-2" title="2"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb102-3" title="3"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Differences between randomised group means&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb102-4" title="4"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> diff_in_means, <span class="dt">col =</span> <span class="st">&quot;cyan4&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>,<span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb102-5" title="5"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&#39;text&#39;</span>, <span class="dt">label =</span> <span class="st">&quot;Observed difference between means&quot;</span> , </a>
<a class="sourceLine" id="cb102-6" title="6">           <span class="dt">x =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">y =</span> <span class="ot">Inf</span>, <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="fl">1.5</span>, <span class="dt">color =</span> <span class="st">&quot;cyan4&quot;</span>)</a></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/hist-1.png" width="672" /></p>
<p>How would the parametric t-test have served?</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">t.test</span>(Length <span class="op">~</span><span class="st"> </span>Species, <span class="dt">data =</span> paua)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Length by Species
## t = 3.5404, df = 57.955, p-value = 0.0007957
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.4158802 1.4980086
## sample estimates:
## mean in group Haliotis australis      mean in group Haliotis iris 
##                         5.766667                         4.809722</code></pre>
<p>Not too different after all</p>
<p><strong>Note</strong></p>
<ul>
<li>In experimental situations a large p-value (large tail proportion) means that the luck of the randomisation quite often produces group differences as large or even larger than what we’ve got in our data.
<ul>
<li>A small p-value means that the luck of the randomisation draw hardly ever produces group differences as large as we’ve got in our data.</li>
<li><strong>Statistical significance does not imply practical significance.</strong></li>
<li><strong>Statistical significance says nothing about the size of treatment differences.</strong> To estimate the sizes of differences you need confidence intervals.</li>
</ul></li>
</ul>
<p><strong>NOTE: We can extend the randomization test to make inference about any sample statistic (not just the mean)</strong></p>
</div>
<div id="one-way-anova-using-lm" class="section level2">
<h2><span class="header-section-number">3.6</span> One way ANOVA using <code>lm()</code></h2>
<p><img src="https://pbs.twimg.com/media/EeMWb7QWsAIGftR?format=jpg&amp;name=small" /></p>
<p>Remember the penguins? <strong>You might find <a href="https://cmjt.shinyapps.io/penguin/">this application</a> useful, now and later…</strong></p>
<p><img src="_main_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Now we have more than two groups: <span class="math inline">\(3\)</span> potential comparisons we might be interested in. Remember that each time we carry out a hypothesis test the probability we get a false positive result (<strong>Type I</strong> error) is given by <span class="math inline">\(\alpha\)</span> (the <strong>level of significance</strong> we choose). In light of this we should control the <strong>Type I</strong> error rate across the entire <em>family</em> of tests under consideration, i.e., control the <strong>Family-Wise Error Rate (FWER)</strong>; this ensures that the risk of making at least one <strong>Type I</strong> error among the family of comparisons in the experiment is <span class="math inline">\(\alpha\)</span>.</p>
<p><strong>AN</strong>alysis Of <strong>VA</strong>riance (ANOVA): this can, again, be done using <code>lm()</code></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1">fit.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(bill_depth_mm <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> penguins_nafree)</a></code></pre></div>
<p><em>F-test</em> using <code>anova()</code></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="co">## using anova()</span></a>
<a class="sourceLine" id="cb107-2" title="2"><span class="kw">anova</span>(fit.lm)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: bill_depth_mm
##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## species     2 870.79  435.39  344.83 &lt; 2.2e-16 ***
## Residuals 330 416.67    1.26                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Consider the ratio <span class="math inline">\({\frac {{\text{variation due to groups}}}{{\text{unexplained variance}}}} = {\frac {{\text{ mean between-group variability}}}{{\text{mean within-group variability}}}}\)</span> <span class="math inline">\(=\frac{\text{mean SSB}}{\text{mean SSW}}\)</span> <span class="math inline">\(=\frac{\text{MSB}}{\text{MSW}}\)</span> = <span class="math inline">\(\frac{435.3925914}{1.2626477}\)</span></p>
<p>This is the <strong>F-statistic</strong>…</p>
<p>Hypothesis: We test the Null hypothesis, <span class="math inline">\(H_0\)</span>, population (<code>species</code>) means are the same on average verses the alternative hypothesis, <span class="math inline">\(H_1\)</span>, that <strong>at least one</strong> differs from the others!</p>
<p>Probability of getting an <strong>F-statistic</strong> at least as extreme as the one we observe (think of the area under the tails of the curve below) <strong>p-value</strong> Pr(&gt;F)= 1.446615710^{-81} tells us we have extremely strong evidence against <span class="math inline">\(H_0\)</span> at the &lt;&lt;0.0001% level of significance</p>
<p><em>F-test</em> using <code>aov()</code></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="co">## using aov()</span></a>
<a class="sourceLine" id="cb109-2" title="2">aov &lt;-<span class="st"> </span><span class="kw">aov</span>(bill_depth_mm <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> penguins_nafree)</a>
<a class="sourceLine" id="cb109-3" title="3"><span class="kw">summary</span>(aov)</a></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## species       2  870.8   435.4   344.8 &lt;2e-16 ***
## Residuals   330  416.7     1.3                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>They are BOTH THE SAME</strong></p>
<p>Taking <strong>species</strong> <code>Adelie</code> as the <strong>baseline</strong> in linear regression…</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="kw">summary</span>(fit.lm)<span class="op">$</span>coef</a></code></pre></div>
<pre><code>##                     Estimate Std. Error     t value     Pr(&gt;|t|)
## (Intercept)      18.34726027 0.09299608 197.2906740 0.000000e+00
## speciesChinstrap  0.07332796 0.16497460   0.4444803 6.569867e-01
## speciesGentoo    -3.35062162 0.13877592 -24.1441135 6.622121e-75</code></pre>
<p>(Intercept) = <span class="math inline">\(\text{mean}_{\text{Adelie}}\)</span> = 18.3472603</p>
<p>SE of (Intercept) = SE of <span class="math inline">\(\text{mean}_{\text{Adelie}}\)</span> = SEM = 18.3472603</p>
<p><span class="math inline">\(\text{speciesChinstrap}\)</span> = <span class="math inline">\(\text{mean}_{\text{Chinstrap}}\)</span> - <span class="math inline">\(\text{mean}_{\text{Adelie}}\)</span> = 0.073328</p>
<p>SE of <span class="math inline">\(\text{speciesChinstrap}\)</span> = SE of (<span class="math inline">\(\text{mean}_{\text{Chinstrap}}\)</span> - <span class="math inline">\(\text{mean}_{\text{Adelie}}\)</span> ) = SED = 0.1649746</p>
<p>What is <span class="math inline">\(\text{mean}_{\text{Gentoo}}\)</span> - <span class="math inline">\(\text{mean}_{\text{Adelie}}\)</span>?</p>
<p><strong>Hypotheses being tested</strong></p>
<ul>
<li><p>The <code>t value</code> and <code>Pr (&gt;|t|)</code> are the t - and p-value for testing the null hypotheses</p>
<ol style="list-style-type: decimal">
<li>Mean abundance is zero for Adelie population</li>
<li>No difference between the population means of Chinstrap and Adelie</li>
<li>No difference between the population means of Gentoo and Adelie</li>
</ol></li>
</ul>
<p>We’re interested in 2 and 3, but not necessarily 1!</p>
<p>What do you conclude? Does your inference match the plot?</p>
</div>
<div id="model-diagnostics" class="section level2">
<h2><span class="header-section-number">3.7</span> Model diagnostics</h2>
<p>Carrying out any linear regression we have some <strong>key assumptions</strong></p>
<ul>
<li><strong>Independence</strong></li>
<li>There is a <strong>linear relationship</strong> between the response and the explanatory variables</li>
<li>The residuals have <strong>constant variance</strong></li>
<li>The <strong>residuals</strong> are normally distributed</li>
</ul>
<p><strong>Diagnostic plots</strong></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1">gglm<span class="op">::</span><span class="kw">gglm</span>(fit.lm) <span class="co"># Plot the four main diagnostic plots</span></a></code></pre></div>
<p><img src="_main_files/figure-html/qqnorm-1.png" width="672" /></p>
<p><strong>Residuals vs Fitted</strong> plot</p>
<p>You are basically looking for no pattern or structure in your residuals (e.g., a “starry” night). You definitely don’t want to see is the scatter increasing around the zero line (dashed line) as the fitted values get bigger (e.g., think of a trumpet, a wedge of cheese, or even a slice of pizza) which would indicate unequal variances (heteroscedacity).</p>
<p>[Note: things look a bit weird, points are in clumps? Why? Well think of the model we fitted (i.e., one with a single factor explanatory variable)]</p>
<p><strong>Normal quantile-quantile (QQ)</strong> plot</p>
<p>This plot shows the sorted residuals versus expected order statistics from a standard normal distribution. Samples should be close to a line; points moving away from 45 degree line at the tails suggest the data are from a skewed distribution.</p>
<p><strong>Scale-Location</strong> plot (<span class="math inline">\(\sqrt{\text{|standardized residuals vs Fitted|}}\)</span>)</p>
<p>Another way to check the homoskedasticity (constant-variance) assumption. We want the line to be roughly horizontal. If this is the case then the average magnitude of the standardized residuals isn’t changing much as a function of the fitted values. We’d also like the spread around the line not to vary much with the fitted values; then the variability of magnitudes doesn’t vary much as a function of the fitted values.</p>
<p><strong>Residuals vs Leverage</strong> plot (standardized residuals vs Leverage)</p>
<p>This can help detect outliers in a linear regression model. For linear regression model leverage measures how sensitive a fitted value is to a change in the true response. We’re looking at how the spread of standardized residuals changes as the leverage. This can also be used to detect heteroskedasticity and non-linearity: the spread of standardized residuals shouldn’t change as a function of leverage. In addition, points with high leverage may be influential: that is, deleting them would change the model a lot.</p>
<p>[Note: things look a bit weird: there are only three points? Why? Well think of the model we fitted (i.e., one with a single factor explanatory variable). We can’t tell much here, bu twill use these plots more later on.]</p>
</div>
<div id="other-resources-optional-but-recommended-2" class="section level2">
<h2><span class="header-section-number">3.8</span> Other resources: optional but recommended</h2>
<ul>
<li><a href="https://www.tandfonline.com/doi/full/10.1080/00031305.2016.1154108">The ASA Statement on p-Values: Context, Process, and Purpose</a></li>
</ul>
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr">
I thought it could be helpful to have a thread on ANOVA in R. As a statistical consultant, this is the most frequent FAQ I get from clients - how to run a linear model on their data, conduct hypothesis tests, extract predicted means and perform contrasts.
</p>
— We are R-Ladies (<span class="citation">@WeAreRLadies</span>) <a href="https://twitter.com/WeAreRLadies/status/1223790298024726528?ref_src=twsrc%5Etfw">February 2, 2020</a>
</blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr">
I've made this cheat sheet and I think it's important. Most stats 101 tests are simple linear models - including “non-parametric” tests. It's so simple we should only teach regression. Avoid confusing students with a zoo of named tests. <a href="https://t.co/9PFR1ly3lW">https://t.co/9PFR1ly3lW</a> 1/n
</p>
— Jonas K. Lindeløv (<span class="citation">@jonaslindeloev</span>) <a href="https://twitter.com/jonaslindeloev/status/1110907133833502721?ref_src=twsrc%5Etfw">March 27, 2019</a>
</blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr">
The aov() function in <a href="https://twitter.com/hashtag/Rstats?src=hash&amp;ref_src=twsrc%5Etfw">#Rstats</a> is actually a wrapper around the lm() function <a href="https://t.co/FbvxQdtD4c">pic.twitter.com/FbvxQdtD4c</a>
</p>
— Dan Quintana (<span class="citation">@dsquintana</span>) <a href="https://twitter.com/dsquintana/status/1189536788790042625?ref_src=twsrc%5Etfw">October 30, 2019</a>
</blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-exploration-and-visualization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistical-inference.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
