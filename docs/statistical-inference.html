<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Statistical Inference | Module I BIOSCI220, University of Auckland</title>
  <meta name="description" content="4 Statistical Inference | Module I BIOSCI220, University of Auckland" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Statistical Inference | Module I BIOSCI220, University of Auckland" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Statistical Inference | Module I BIOSCI220, University of Auckland" />
  
  
  

<meta name="author" content="Charlotte Jones-Todd" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="hypothesis-testing-and-introduction-to-linear-regression.html"/>
<link rel="next" href="experimental-design.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#course-overview-biosci220"><i class="fa fa-check"></i><b>0.1</b> Course Overview: BIOSCI220</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#module-1-key-topics"><i class="fa fa-check"></i><b>0.2</b> Module 1: Key Topics</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#timetable-assessment-modules-i-ii-and-iii"><i class="fa fa-check"></i><b>0.3</b> Timetable &amp; Assessment (Modules I, II, and III)</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> <code>R</code> and <code>RStudio</code></a><ul>
<li class="chapter" data-level="1.1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#introduction-to-r-and-rstudio"><i class="fa fa-check"></i><b>1.2</b> Introduction to <code>R</code> and <code>RStudio</code></a></li>
<li class="chapter" data-level="1.3" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#exploratory-data-analysis-eda"><i class="fa fa-check"></i><b>1.3</b> Exploratory Data Analysis (EDA)</a></li>
<li class="chapter" data-level="1.4" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#other-resources-optional-but-recommended"><i class="fa fa-check"></i><b>1.4</b> Other resources: optional but recommended</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html"><i class="fa fa-check"></i><b>2</b> Data exploration and visualization</a><ul>
<li class="chapter" data-level="2.1" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#learning-objectives-1"><i class="fa fa-check"></i><b>2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="2.2" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#data-sovereignty"><i class="fa fa-check"></i><b>2.2</b> Data sovereignty</a></li>
<li class="chapter" data-level="2.3" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#data-wrangling-and-manipulation"><i class="fa fa-check"></i><b>2.3</b> Data wrangling and manipulation</a></li>
<li class="chapter" data-level="2.4" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#data-viz"><i class="fa fa-check"></i><b>2.4</b> Data Viz</a></li>
<li class="chapter" data-level="2.5" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#other-resources-optional-but-recommended-1"><i class="fa fa-check"></i><b>2.5</b> Other resources: optional but recommended</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Hypothesis testing and introduction to linear regression</a><ul>
<li class="chapter" data-level="3.1" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#learning-objectives-2"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#introdcution-to-hypothesis-testing"><i class="fa fa-check"></i><b>3.2</b> Introdcution to hypothesis testing</a></li>
<li class="chapter" data-level="3.3" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#correctly-interpreting-p-values"><i class="fa fa-check"></i><b>3.3</b> ðŸ˜± Correctly interpreting p-values ðŸ˜±</a></li>
<li class="chapter" data-level="3.4" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#power-significance-and-multiple-comparisons"><i class="fa fa-check"></i><b>3.4</b> Power, Significance, and multiple comparisons</a></li>
<li class="chapter" data-level="3.5" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#randomization-test"><i class="fa fa-check"></i><b>3.5</b> Randomization test</a></li>
<li class="chapter" data-level="3.6" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#one-way-anova-using-lm"><i class="fa fa-check"></i><b>3.6</b> One way ANOVA using <code>lm()</code></a></li>
<li class="chapter" data-level="3.7" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#model-diagnostics"><i class="fa fa-check"></i><b>3.7</b> Model diagnostics</a></li>
<li class="chapter" data-level="3.8" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#other-resources-optional-but-recommended-2"><i class="fa fa-check"></i><b>3.8</b> Other resources: optional but recommended</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>4</b> Statistical Inference</a><ul>
<li class="chapter" data-level="4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#learning-objectives-3"><i class="fa fa-check"></i><b>4.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#regression"><i class="fa fa-check"></i><b>4.2</b> Regression</a></li>
<li class="chapter" data-level="4.3" data-path="statistical-inference.html"><a href="statistical-inference.html#model-comparison-selection-and-checking-again"><i class="fa fa-check"></i><b>4.3</b> Model, comparison, selection, and checking (again)</a></li>
<li class="chapter" data-level="4.4" data-path="statistical-inference.html"><a href="statistical-inference.html#confidence-intervals"><i class="fa fa-check"></i><b>4.4</b> Confidence intervals</a></li>
<li class="chapter" data-level="4.5" data-path="statistical-inference.html"><a href="statistical-inference.html#tldr-lm"><i class="fa fa-check"></i><b>4.5</b> TL;DR <code>lm()</code></a></li>
<li class="chapter" data-level="4.6" data-path="statistical-inference.html"><a href="statistical-inference.html#other-resources-optional-but-recommended-3"><i class="fa fa-check"></i><b>4.6</b> Other resources: optional but recommended</a></li>
<li class="chapter" data-level="4.7" data-path="statistical-inference.html"><a href="statistical-inference.html#beyond-linear-models-to-generalised-linear-models-glms-not-examinable"><i class="fa fa-check"></i><b>4.7</b> Beyond Linear Models to Generalised Linear Models (GLMs) (<em>not examinable</em>)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="experimental-design.html"><a href="experimental-design.html"><i class="fa fa-check"></i><b>5</b> Experimental Design</a></li>
<li class="chapter" data-level="6" data-path="multivariate-data-methods.html"><a href="multivariate-data-methods.html"><i class="fa fa-check"></i><b>6</b> Multivariate Data Methods</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Module I BIOSCI220, University of Auckland</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistical-inference" class="section level1">
<h1><span class="header-section-number">4</span> Statistical Inference</h1>
<div id="learning-objectives-3" class="section level2">
<h2><span class="header-section-number">4.1</span> Learning Objectives</h2>
<ul>
<li>Carry out and interpret tests for the existence of relationships between explanatory variables and the response in a linear model</li>
<li>Write R code to fit a linear model with a single continuous explanatory variable</li>
<li>Write R code to fit a linear model with a continuous explanatory variable and a factor explanatory variable</li>
<li>Interpret estimated effects with reference to confidence intervals from linear regression models. Specifically the interpretation of
<ul>
<li>the intercept</li>
<li>the effect of a factor</li>
<li>the effect of a one-unit increase in a numeric variable</li>
<li>the effect of an x-unit increase in a numeric variable</li>
</ul></li>
<li>Make a point prediction of the response for a new observation</li>
<li>Write R code to fit a linear model with interaction terms in the explanatory variables</li>
<li>Interpret estimated effects with reference to confidence intervals from linear regression models. Specifically the interpretation of
<ul>
<li>main effects in a model with an interaction</li>
<li>the effect of one variable when others are included in the model</li>
</ul></li>
<li>Explain why you may want to include interaction effects in a linear model</li>
<li>Describe the differences between the operators <code>:</code> and <code>*</code> in an <code>R</code> model-fitting formula</li>
</ul>
</div>
<div id="regression" class="section level2">
<h2><span class="header-section-number">4.2</span> Regression</h2>
<div class="figure">
<img src="https://raw.githubusercontent.com/cmjt/statbiscuits/master/figs_n_gifs/lm.gif" />

</div>
<div id="some-mathematical-notation" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Some mathematical notation</h3>
<p>Let's consider a linear regression with a simple explanatory variable:</p>
<p><span class="math display">\[Y_i = \alpha + \beta_1x_i + \epsilon_i\]</span> where</p>
<p><span class="math display">\[\epsilon_i \sim \text{Normal}(0,\sigma^2).\]</span></p>
<p>Here for observation <span class="math inline">\(i\)</span></p>
<ul>
<li><span class="math inline">\(Y_i\)</span> is the value of the response</li>
<li><span class="math inline">\(x_i\)</span> is the value of the explanatory variable</li>
<li><span class="math inline">\(\epsilon_i\)</span> is the error term: the difference between <span class="math inline">\(Y_i\)</span> and its expected value</li>
<li><span class="math inline">\(\alpha\)</span> is the intercept term (a parameter to be estimated), and</li>
<li><span class="math inline">\(\beta_1\)</span> is the slope: coefficient of the explanatory variable (a parameter to be estimated), and</li>
</ul>
<p>Does this remind you of anything?</p>
<div class="figure">
<img src="https://memegenerator.net/img/instances/63099571/one-does-not-simply-forget-ymxc.jpg" />

</div>
</div>
<div id="modeling-bill-depth" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Modeling Bill Depth</h3>
<div class="figure">
<img src="https://cran.r-project.org/web/packages/palmerpenguins/readme/man/figures/culmen_depth.png" />

</div>
<p><strong>Key assumptions</strong></p>
<ul>
<li><strong>Independence</strong></li>
<li>There is a <strong>linear relationship</strong> between the response and the explanatory variables</li>
<li>The residuals have <strong>constant variance</strong></li>
<li>The <strong>residuals</strong> are normally distributed</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(palmerpenguins)
penguins_nafree &lt;-<span class="st"> </span>penguins <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> penguins_nafree, <span class="kw">aes</span>(<span class="dt">x =</span> bill_depth_mm)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Bill depth (mm)&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>First off let's fit a null (intercept only) model. This in <em>old money</em> would be called a one sample t-test.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">slm_null &lt;-<span class="st"> </span><span class="kw">lm</span>(bill_depth_mm <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> penguins_nafree)
<span class="kw">summary</span>(slm_null)<span class="op">$</span>coef</code></pre></div>
<pre><code>##             Estimate Std. Error  t value      Pr(&gt;|t|)
## (Intercept) 17.16486  0.1079134 159.0614 1.965076e-315</code></pre>
<p><strong>Model formula</strong></p>
<p>The <code>(Intercept)</code> term, 17.1648649, tells us the average value of the response (<code>bill_depth_mm</code>), see</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">penguins_nafree <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">average_bill_depth =</span> <span class="kw">mean</span>(bill_depth_mm))</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   average_bill_depth
##                &lt;dbl&gt;
## 1               17.2</code></pre>
<p><strong>Inference</strong></p>
<p>The SEM (<code>Std. Error</code>) = 0.1079134.</p>
<p>The hypothesis being tested is <span class="math inline">\(H_0:\)</span> (<code>(Intercept)</code> ) <span class="math inline">\(\text{mean}_{\text{`average_bill_depth`}} = 0\)</span> vs. <span class="math inline">\(H_1:\)</span> (<code>(Intercept)</code>) <span class="math inline">\(\text{mean}_{\text{`average_bill_depth`}} \neq 0\)</span></p>
<p>The t-statistic is given by <code>t value</code> = <code>Estimate</code> + <code>Std. Error</code> = 159.0614207</p>
<p>The p-value is given by<code>Pr (&gt;|t|)</code> = 1.965076110^{-315}.</p>
<p>So the probability of observing a t-statistic as least as extreme given under the null hypothesis (average bill depth = 0) given our data is 1.965076110^{-315}, pretty strong evidence against the null hypothesis I'd say!</p>
</div>
<div id="single-continuous-variable" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Single continuous variable</h3>
<p><strong>Does <code>bill_length_mm</code> help explain some of the variation in <code>bill_depth_mm</code>?</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> penguins_nafree, <span class="kw">aes</span>(<span class="dt">x =</span> bill_length_mm, <span class="dt">y =</span> bill_depth_mm)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Bill depth (mm)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Bill length (mm)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>()
p1</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">slm &lt;-<span class="st"> </span><span class="kw">lm</span>(bill_depth_mm <span class="op">~</span><span class="st"> </span>bill_length_mm, <span class="dt">data =</span> penguins_nafree)</code></pre></div>
<p><strong>Model formula</strong></p>
<p><span class="math display">\[
\begin{aligned}
\operatorname{bill\_depth\_mm} &amp;= \alpha + \beta_{1}(\operatorname{bill\_length\_mm}) + \epsilon
\end{aligned}
\]</span></p>
<p><strong>Fitted model</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(slm)<span class="op">$</span>coef</code></pre></div>
<pre><code>##                   Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)    20.78664867 0.85417308 24.335406 1.026904e-75
## bill_length_mm -0.08232675 0.01926835 -4.272642 2.528290e-05</code></pre>
<p>Here, the <code>(Intercept)</code>: <code>Estimate</code> gives us the estimated average bill depth (mm) <strong>given the estimated relationship</strong> bill length (mm) and bill length.</p>
<p>The <code>bill_length_mm</code> : <code>Estimate</code> (think of <span class="math inline">\(\beta_1\)</span> above) is the slope associated with bill length (mm). So, here for every 1mm increase in bill length we estimated a 0.082mm decrease (or a -0.082mm increase) in bill depth.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## calculate predicted values
penguins_nafree<span class="op">$</span>pred_vals &lt;-<span class="st"> </span><span class="kw">predict</span>(slm)
## plot
<span class="kw">ggplot</span>(<span class="dt">data =</span> penguins_nafree, <span class="kw">aes</span>(<span class="dt">x =</span> bill_length_mm, <span class="dt">y =</span> bill_depth_mm)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Bill depth (mm)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Bill length (mm)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pred_vals))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
<div id="factor-and-a-continous-variable" class="section level3">
<h3><span class="header-section-number">4.2.4</span> Factor and a continous variable</h3>
<p><strong>Adding</strong> <code>species</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> penguins_nafree, <span class="kw">aes</span>(<span class="dt">y =</span> bill_depth_mm, <span class="dt">x =</span> bill_length_mm, <span class="dt">color =</span> species)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Bill depth (mm)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Bill length (mm)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() 
p2</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">slm_sp &lt;-<span class="st"> </span><span class="kw">lm</span>(bill_depth_mm <span class="op">~</span><span class="st"> </span>bill_length_mm <span class="op">+</span><span class="st"> </span>species, <span class="dt">data =</span> penguins_nafree)</code></pre></div>
<p><strong>Model formula</strong></p>
<p><span class="math display">\[
\begin{aligned}
\operatorname{bill\_depth\_mm} &amp;= \alpha + \beta_{1}(\operatorname{bill\_length\_mm}) + \beta_{2}(\operatorname{species}_{\operatorname{Chinstrap}}) + \beta_{3}(\operatorname{species}_{\operatorname{Gentoo}})\ + \\
&amp;\quad \epsilon
\end{aligned}
\]</span></p>
<p><strong>Fitted model</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(slm_sp)<span class="op">$</span>coef</code></pre></div>
<pre><code>##                    Estimate Std. Error    t value     Pr(&gt;|t|)
## (Intercept)      10.5652616 0.69092642  15.291442 2.977289e-40
## bill_length_mm    0.2004431 0.01767974  11.337449 2.258955e-25
## speciesChinstrap -1.9330779 0.22571878  -8.564099 4.259893e-16
## speciesGentoo    -5.1033153 0.19439523 -26.252267 1.043789e-82</code></pre>
<p><em>Simpson's paradox...</em> look how the slopes have switched direction from the model above.</p>
<p>Remember when we have factor explanatory variables (e.g., <code>species</code>) we have to use dummy variables, see lecture. Here the <strong>Adelie</strong> group are the baseline (<code>R</code> does this alphabetically, to change this see previous chapter).</p>
<p>Here, the <code>(Intercept)</code>: <code>Estimate</code> gives us the estimated average bill depth (mm) of the <em>Adelie</em> penguins <strong>given the ther variables in the model</strong>.</p>
<p>The <code>bill_length_mm</code> : <code>Estimate</code> (think of <span class="math inline">\(\beta_1\)</span> above) is the slope associated with bill length (mm). So, here for every 1mm increase in bill length we estimated a 0.082mm decrease (or a -0.082mm increase) in bill depth.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## calculate predicted values
penguins_nafree<span class="op">$</span>pred_vals &lt;-<span class="st"> </span><span class="kw">predict</span>(slm_sp)
## plot
<span class="kw">ggplot</span>(<span class="dt">data =</span> penguins_nafree, <span class="kw">aes</span>(<span class="dt">y =</span> bill_depth_mm, <span class="dt">x =</span> bill_length_mm, <span class="dt">color =</span> species)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Bill depth (mm)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Bill length (mm)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>()  <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pred_vals))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
</div>
<div id="interactions" class="section level3">
<h3><span class="header-section-number">4.2.5</span> Interactions</h3>
<p>Recap</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1z_i + \beta_2x_i + \epsilon_i\]</span> <span class="math display">\[\epsilon_i \sim \text{Normal}(0,\sigma^2)\]</span> Here for observation <span class="math inline">\(i\)</span></p>
<ul>
<li><span class="math inline">\(Y_i\)</span> is the value of the response</li>
<li><span class="math inline">\(z_i\)</span> is one explanatory variable</li>
<li><span class="math inline">\(x_i\)</span> is another explanatory variable</li>
<li><span class="math inline">\(\epsilon_i\)</span> is the error term: the difference between <span class="math inline">\(Y_i\)</span> and its expected value</li>
</ul>
<p><strong>But</strong> what about interactions? For example,</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1z_i + \beta_2x_i + \beta_3z_ix_i + \epsilon_i\]</span> <span class="math display">\[\epsilon_i \sim \text{Normal}(0,\sigma^2)\]</span></p>
<p><strong>Note:</strong> to include interaction effects in our model by using either the <code>*</code> or <code>:</code> syntax in our model formula. See [Model formula syntax] for further details.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">slm_int &lt;-<span class="st"> </span><span class="kw">lm</span>(bill_depth_mm <span class="op">~</span><span class="st"> </span>bill_length_mm<span class="op">*</span>species, <span class="dt">data =</span> penguins_nafree)</code></pre></div>
<p><strong>Model formula</strong></p>
<p><span class="math display">\[
\begin{aligned}
\operatorname{bill\_depth\_mm} &amp;= \alpha + \beta_{1}(\operatorname{bill\_length\_mm}) + \beta_{2}(\operatorname{species}_{\operatorname{Chinstrap}}) + \beta_{3}(\operatorname{species}_{\operatorname{Gentoo}})\ + \\
&amp;\quad \beta_{4}(\operatorname{bill\_length\_mm} \times \operatorname{species}_{\operatorname{Chinstrap}}) + \beta_{5}(\operatorname{bill\_length\_mm} \times \operatorname{species}_{\operatorname{Gentoo}}) + \epsilon
\end{aligned}
\]</span></p>
<p><strong>Fitted model</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(slm_int)<span class="op">$</span>coef</code></pre></div>
<pre><code>##                                    Estimate Std. Error    t value     Pr(&gt;|t|)
## (Intercept)                     11.48770713 1.15987305  9.9042797 2.135979e-20
## bill_length_mm                   0.17668344 0.02980564  5.9278518 7.793199e-09
## speciesChinstrap                -3.91856701 2.06730876 -1.8954919 5.890889e-02
## speciesGentoo                   -6.36675118 1.77989710 -3.5770333 4.000274e-04
## bill_length_mm:speciesChinstrap  0.04552828 0.04594283  0.9909769 3.224296e-01
## bill_length_mm:speciesGentoo     0.03092816 0.04111608  0.7522157 4.524625e-01</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## calculate predicted values
penguins_nafree<span class="op">$</span>pred_vals &lt;-<span class="st"> </span><span class="kw">predict</span>(slm_int)
## plot
<span class="kw">ggplot</span>(<span class="dt">data =</span> penguins_nafree, <span class="kw">aes</span>(<span class="dt">y =</span> bill_depth_mm, <span class="dt">x =</span> bill_length_mm, <span class="dt">color =</span> species)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Bill depth (mm)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Bill length (mm)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>()  <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pred_vals))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p><strong>Are the non-parallel lines non-parallel enough to reject the parallel line model?</strong> (<em>more below</em>)</p>
<div id="model-formula-syntax" class="section level4">
<h4><span class="header-section-number">4.2.5.1</span> <strong>Model formula</strong> syntax</h4>
<p>In <code>R</code> to specify the model you want to fit you typically create a model formula object; this is usually then passed as the first argument to the model fitting function (e.g., <code>lm()</code>).</p>
<p>Some notes on syntax:</p>
<p>Consider the model formula example <code>y ~ x + z + x:z</code>. There is a lot going on here:</p>
<ul>
<li>The variable to the left of <code>~</code> specifies the response, everything to the right specify the explanatory variables</li>
<li><code>+</code> indicated to include the variable to the left of it and to the right of it (it does <strong>not</strong> mean they should be summed)</li>
<li><code>:</code> denotes the interaction of the variables to its left and right</li>
</ul>
<p>Additional, some other symbols have special meanings in model formula:</p>
<ul>
<li><p><code>*</code> means to include all main effects and interactions, so <code>a*b</code> is the same as <code>a + b + a:b</code></p></li>
<li><code>^</code> is used to include main effects and interactions up to a specified level. For example, <code>(a + b + c)^2</code> is equivalent to <code>a + b + c + a:b + a:c + b:c</code> (note <code>(a + b + c)^3</code> would also add <code>a:b:c</code>)</li>
<li><p><code>-</code> excludes terms that might otherwise be included. For example, <code>-1</code> excludes the intercept otherwise included by default, and <code>a*b - b</code> would produce <code>a + a:b</code></p></li>
</ul>
<p>Mathematical functions can also be directly used in the model formula to transform a variable directly (e.g., <code>y ~ exp(x) + log(z) + x:z</code>). One thing that may seem counter intuitive is in creating polynomial expressions (e.g., <span class="math inline">\(x^2\)</span>). Here the expression <code>y ~ x^2</code> does <strong>not</strong> relate to squaring the explanatory variable <span class="math inline">\(x\)</span> (this is to do with the syntax <code>^</code> you see above. To include <span class="math inline">\(x^2\)</span> as a term in our model we have to use the <code>I()</code> (the &quot;as-is&quot; operator). For example, <code>y ~ I(x^2)</code>).</p>
</div>
</div>
</div>
<div id="model-comparison-selection-and-checking-again" class="section level2">
<h2><span class="header-section-number">4.3</span> Model, comparison, selection, and checking (again)</h2>
<p>Remember that it is always is imperative that we <strong>check the underlying assumptions</strong> of our model! If our assumptions are not met then basically the maths falls over and we can't reliably draw inference from the model (e.g., can't trust the parameter estimates etc.). Two of the most important assumption are:</p>
<ul>
<li><p>equal variances (homogeneity of variance), and</p></li>
<li><p>normality of residuals.</p></li>
</ul>
<div id="model-comparison-and-selection" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Model comparison and selection</h3>
<p><strong>Are the non-parallel lines non-parallel enough to reject the parallel line model?</strong></p>
<p>We can compare nested<span class="math inline">\(^*\)</span> linear models by hypothesis testing. Luckily the <code>R</code> function <code>anova()</code> automates this. Yes the same idea as we've previously learnt about ANOVA! We essentially perform an F-ratio test between the nested models!</p>
<p><span class="math inline">\(^*\)</span>By nested we mean that one model is a subset of the other (i.e., where some coefficients have been fixed at zero). For example,</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1z_i + \epsilon_i\]</span></p>
<p>is a nested version of</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1z_i + \beta_2x_i + \epsilon_i\]</span> where <span class="math inline">\(\beta_2\)</span> has been fixed to zero.</p>
<p>As an example consider testing the null model <code>slm_null</code> against the full model with interactions <code>slm_int</code>. To carry out the appropriate hypothesis test in <code>R</code> we can run</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(mod.no.c,mod.interaction)</code></pre></div>
<p>The Akaike information criterion (AIC) from Module 2 of the course. AICs an estimator of out-of-sample prediction error and can be used as a metric to choose between competing models. <code>R</code> already has an <code>AIC()</code> function that can be used directly on your <code>lm()</code> model object(s). For example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">AIC</span>(mod.add,mod.interaction)</code></pre></div>
<p>This backs up what our AIC values indicated. The p-value tells us that we have really strong evidence (p-value is exceptionally low) against the null model (<code>mod.no.c</code>) in favor of the model that includes interactions!</p>
<p>As always it's important to do a sanity check! Does this make sense? Based on what we know about C02 emissions and food types I'd say YES!</p>
</div>
</div>
<div id="confidence-intervals" class="section level2">
<h2><span class="header-section-number">4.4</span> Confidence intervals</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confint</span>(multiple.mod)</code></pre></div>
<div id="interpreting-confidence-intervals" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Interpreting confidence intervals</h3>
<ul>
<li><p>For every 1mm increase in mesosoma length we estimate the expected sting length to increases between <code>round(confint(multiple.mod)[9,1],1)</code> and <code>round(confint(multiple.mod)[9,2],1)</code> mm</p></li>
<li><p>We estimate that the expected sting length of a species predated by Immature Hymenoptera is between <code>round(confint(multiple.mod)[6,1],1)</code> and <code>round(confint(multiple.mod)[6,2],1)</code> mm longer than that predated by Coleoptera with the same sting length</p></li>
</ul>
<div id="point-prediction" class="section level4">
<h4><span class="header-section-number">4.4.1.1</span> Point prediction</h4>
<p>For species predated by Immature Hymenoptera with mesosomal length 5mm</p>
<p><span class="math display">\[\hat{\text{Age}} = \hat{\beta_0} + \hat{\beta_5}*1 + \hat{\beta_8}*5\]</span> <span class="math display">\[\downarrow\]</span></p>
<p><span class="math display">\[\hat{\text{Age}} = -0.99 + 4.25*1 + 0.87*5\]</span> <span class="math display">\[\downarrow\]</span></p>
<p><span class="math display">\[7.61\]</span></p>
</div>
<div id="in-r" class="section level4">
<h4><span class="header-section-number">4.4.1.2</span> In <code>R</code></h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## create new data frame with data we want to predict to
newdata &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">prey_graph =</span> <span class="st">&quot;Immature Hymenoptera&quot;</span>,<span class="dt">mesosoma =</span> <span class="dv">5</span>)
## use predict() function
<span class="kw">predict</span>(multiple.mod, <span class="dt">newdata =</span> newdata)
## round to 2 d.p
<span class="kw">round</span>(<span class="kw">predict</span>(multiple.mod, <span class="dt">newdata =</span> newdata),<span class="dv">2</span>)</code></pre></div>
</div>
</div>
</div>
<div id="tldr-lm" class="section level2">
<h2><span class="header-section-number">4.5</span> TL;DR <code>lm()</code></h2>
<table style="width:64%;">
<colgroup>
<col width="27%" />
<col width="23%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th>Traditional name</th>
<th align="center">Model formula</th>
<th align="right">R code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Simple regression</td>
<td align="center"><span class="math inline">\(Y \sim X_{continuous}\)</span></td>
<td align="right"><code>lm(Y ~ X)</code></td>
</tr>
<tr class="even">
<td>One-way ANOVA</td>
<td align="center"><span class="math inline">\(Y \sim X_{categorical}\)</span></td>
<td align="right"><code>lm(Y ~ X)</code></td>
</tr>
<tr class="odd">
<td>Two-way ANOVA</td>
<td align="center"><span class="math inline">\(Y \sim X1_{categorical} + X2_{categorical}\)</span></td>
<td align="right"><code>lm(Y ~ X1 + X2)</code></td>
</tr>
<tr class="even">
<td>ANCOVA</td>
<td align="center"><span class="math inline">\(Y \sim X1_{continuous} + X2_{categorical}\)</span></td>
<td align="right"><code>lm(Y ~ X1 + X2)</code></td>
</tr>
<tr class="odd">
<td>Multiple regression</td>
<td align="center"><span class="math inline">\(Y \sim X1_{continuous} + X2_{continuous}\)</span></td>
<td align="right"><code>lm(Y ~ X1 + X2)</code></td>
</tr>
<tr class="even">
<td>Factorial ANOVA</td>
<td align="center"><span class="math inline">\(Y \sim X1_{categorical} * X2_{categorical}\)</span></td>
<td align="right"><code>lm(Y ~ X1 * X2)</code> or <code>lm(Y ~ X1 + X2 + X1:X2)</code></td>
</tr>
</tbody>
</table>
<p><strong><a href="https://github.com/allisonhorst/stats-illustrations">Artwork by @allison_horst</a></strong></p>
<div class="figure">
<img src="https://github.com/allisonhorst/stats-illustrations/blob/master/other-stats-artwork/dragons.png?raw=true" alt="Meet your MLR teaching assistants" />
<p class="caption">Meet your MLR teaching assistants</p>
</div>
<div class="figure">
<img src="https://github.com/allisonhorst/stats-illustrations/blob/master/other-stats-artwork/dragon_regression.png?raw=true" alt="Interpret coefficients for categorical predictor variables" />
<p class="caption">Interpret coefficients for categorical predictor variables</p>
</div>
<div class="figure">
<img src="https://github.com/allisonhorst/stats-illustrations/blob/master/other-stats-artwork/dragons_continuous.png?raw=true" alt="Interpret coefficients for continuous predictor variables" />
<p class="caption">Interpret coefficients for continuous predictor variables</p>
</div>
<div class="figure">
<img src="https://github.com/allisonhorst/stats-illustrations/blob/master/other-stats-artwork/dragon_predict_mlr.png?raw=true" alt="Make predictions using the regression model" />
<p class="caption">Make predictions using the regression model</p>
</div>
<div class="figure">
<img src="https://github.com/allisonhorst/stats-illustrations/blob/master/other-stats-artwork/dragon_residual.png?raw=true" alt="Residuals" />
<p class="caption">Residuals</p>
</div>
<div class="figure">
<img src="https://github.com/allisonhorst/stats-illustrations/blob/master/other-stats-artwork/dragon_residual_distribution.png?raw=true" alt="Check residuals for normality" />
<p class="caption">Check residuals for normality</p>
</div>
</div>
<div id="other-resources-optional-but-recommended-3" class="section level2">
<h2><span class="header-section-number">4.6</span> Other resources: optional but recommended</h2>
<ul>
<li><a href="https://interactions.jacob-long.com/articles/interactions.html">Exploring interactions with continuous predictors in regression models</a></li>
<li><a href="https://www.tandfonline.com/doi/full/10.1080/00031305.2016.1154108">The ASA Statement on p-Values: Context, Process, and Purpose</a></li>
</ul>
</div>
<div id="beyond-linear-models-to-generalised-linear-models-glms-not-examinable" class="section level2">
<h2><span class="header-section-number">4.7</span> Beyond Linear Models to Generalised Linear Models (GLMs) (<em>not examinable</em>)</h2>
<p>Recall the assumptions of a linear model</p>
<ul>
<li>The <span class="math inline">\(i\)</span>th observation's response, <span class="math inline">\(Y_i\)</span>, comes from a normal distribution</li>
<li>Its mean, <span class="math inline">\(\mu_i\)</span>, is a linear combination of the explanatory terms</li>
<li>Its variance, <span class="math inline">\(\sigma^2\)</span>, is the same for all observations</li>
<li>Each observation's response is independent of all others</li>
</ul>
<p>But, what if we want to rid ourselves from a model with normal errors?</p>
<p>The answer: Generalised Linear Models.</p>
<div id="counting-animals..." class="section level3">
<h3><span class="header-section-number">4.7.1</span> Counting animals...</h3>
<p>A normal distribution does not adequately describe the response, the number of animals</p>
<ul>
<li>It is a continuous distribution, but the response is discrete</li>
<li>It is symmetric, but the response is unlikely to be so</li>
<li>It is unbounded, and assumes it is plausible for the response to be negative</li>
</ul>
<p>I addition, a linear regression model typically assumes constant variance, but int his situation this unlikely to be the case.</p>
<p>So why assume a normal distribution? Let's use a Poisson distribution instead.</p>
<span class="math display">\[\begin{equation*}    
    \mu_i = \beta_0 + \beta_1 x_i,
  \end{equation*}\]</span>
So
<span class="math display">\[\begin{equation*}
    Y_i \sim \text{Normal}(\mu_i\, \sigma^2),
  \end{equation*}\]</span>
<p>becomes</p>
<span class="math display">\[\begin{equation*}
    Y_i \sim \text{Poisson}(\mu_i),
\end{equation*}\]</span>
<p>The Poisson distribution is commonly used as a general-purpose distribution for counts. A key feature of this distribution is <span class="math inline">\(\text{Var}(Y_i) = \mu_i\)</span>, so we expect the variance to increase with the mean.</p>
</div>
<div id="other-modelling-approaches-for-interest-only" class="section level3">
<h3><span class="header-section-number">4.7.2</span> Other modelling approaches (for interest only)</h3>
<table style="width:57%;">
<colgroup>
<col width="22%" />
<col width="34%" />
</colgroup>
<thead>
<tr class="header">
<th><code>R</code> function</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>glm()</code></td>
<td>Fit a linear model with a specific error structure specified using the <code>family =</code> argument (Poisson, binomial, gamma)</td>
</tr>
<tr class="even">
<td><code>gam()</code></td>
<td>Fit a generalised additive model. The R package <code>mgcv</code> must be loaded</td>
</tr>
<tr class="odd">
<td><code>lme()</code> and <code>nlme()</code></td>
<td>Fit linear and non-linear mixed effects models. The R package <code>nlme</code> must be loaded</td>
</tr>
<tr class="even">
<td><code>lmer()</code></td>
<td>Fit linear and generalised linear and non-linear mixed effects models. The package <code>lme4</code> must be installed and loaded</td>
</tr>
<tr class="odd">
<td><code>gls()</code></td>
<td>Fit generalised least squares models. The R package <code>nlme</code> must be loaded</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="hypothesis-testing-and-introduction-to-linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="experimental-design.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
