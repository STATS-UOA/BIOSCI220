<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>BIOSCI220</title>
    <meta charset="utf-8" />
    <meta name="author" content="Charlotte Jones-Todd" />
    <link href="libs/countdown/countdown.css" rel="stylesheet" />
    <script src="libs/countdown/countdown.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# BIOSCI220
## Module 1, Semester 1 2021
### Charlotte Jones-Todd
### Find the <a href="https://stats-uoa.github.io/BIOSCI220/"><strong>coursebook</strong> here</a>
### © Universty of Auckland

---

class: inverse, center, middle

# `R` and `RStudio`
## Week 1





&lt;style type="text/css"&gt;
.remark-slide-content {
    font-size: 30px;
    padding: 1em 4em 1em 4em;
}
&lt;/style&gt;


---
class: inverse


.small[
### Learning objectives
+ **Define** the difference between `R` and `RStudio`
+ **Express** the benefits and issues associated with these software being used in the scientific community
+ **Distinguish** between different data types (e.g., integers, characters, logical, numerical)
+ **Explain** what an `R` function is; **describe** what an argument to an `R` function is
]

---
class: inverse


.small[
### Learning objectives
+ **Explain** what an `R` package is; **distinguish** between the functions `install.packages()` and `library()`
+ **Explain** what a *working directory* is in the context of `R`
+ **Interpret** and fix basic  `R` errors
+ **Use** the appropriate `R` function to read in a `.csv` data; **carry out** basic exploratory data analysis using `tidyverse` (use the pipe operator, `%&gt;%` when summarising a `data.frame`); create simple plots of the data.
]

---
class: center, middle



The selling pitch of this course states that *...biological research has actually been heavily quantitative for 100+ years...* and promises that *...it is now essential for biology students to acquire skills in working with and visualising data, learning from data using models...*. We're not making it up! 

---

## Why `R`? 
### not an extensive list

--
+ Free

--
+ Open source

--
+ Huge online support network

--
+ Flexible; if you can code it you can do it!

--
+ Everybody's doing it...


---

## a`R`t

.pull-left[

```r
## devtools::install_github("djnavarro/turmite59")
turmite59::turmite59("blue")
```
]

.pull-right[
&lt;img src = "img/turmite_59_blue.png"&gt;
]

.footnote[[Artwork by @djnavarro](https://djnavarro.net/)]

---

## Why `RStudio`? 
### not an extensive list

--
+ Works nicely with `R`

--
+ Huge online support network

--
+ Flexible; so, so, many tools and additions!

--
+ Reproduciblity

---
class: inverse, center, middle

&lt;img src="https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/r_rollercoaster.png" width="90%"&gt;

[Artwork by @allison_horst](https://github.com/allisonhorst/stats-illustrations)

---

## Terminology

--

+ **running** code: the act of telling R to perform an act by giving it commands in the console
--

+ **objects**: what values are stored in
--

+ **script**: a text file containing a set of commands and comments
--

+ **comments**: notes written within a **script** to better document/explain what's happening
--

---

## More terminology

--

+ **functions**: `R` commands that tell your computer what to do
--

+ **arguments**: inputs we give to **functions** that are used by that **function** to give some output
--

+ **packages**: a collection of specific **functions** 

---

## Errors


```r
library(tidy)
```

```
## Error in library(tidy): there is no package called 'tidy'
```

---

## Errors


```r
lbrary(tidyverse)
```

```
## Error in lbrary(tidyverse): could not find function "lbrary"
```

---

## Errors


```r
paua &lt;- read_csv("paua.csv")
```

```
## Error in read_csv("paua.csv"): could not find function "read_csv"
```

---

## Errors


```r
library(tidyverse)
paua &lt;- read_csv("paua.csv")
```

```
## Error: 'paua.csv' does not exist in current working directory ('/home/charlotte/Git/BIOSCI220/slides').
```


---






count: false
 
### Everything working nicely!
.panel1-example_read-auto[

```r
*library(tidyverse)
```
]
 
.panel2-example_read-auto[

]

---
count: false
 
### Everything working nicely!
.panel1-example_read-auto[

```r
library(tidyverse)
*paua &lt;- read_csv("../data/paua.csv")
```
]
 
.panel2-example_read-auto[

```
## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   Species = col_character(),
##   Length = col_double(),
##   Age = col_double()
## )
```
]

---
count: false
 
### Everything working nicely!
.panel1-example_read-auto[

```r
library(tidyverse)
paua &lt;- read_csv("../data/paua.csv")
*glimpse(paua)
```
]
 
.panel2-example_read-auto[

```
## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   Species = col_character(),
##   Length = col_double(),
##   Age = col_double()
## )
```

```
## Rows: 60
## Columns: 3
## $ Species &lt;chr&gt; "Haliotis iris", "Haliotis australis", "Haliotis australis", "…
## $ Length  &lt;dbl&gt; 1.80, 5.40, 4.80, 5.75, 5.65, 2.80, 5.90, 3.75, 7.20, 4.25, 6.…
## $ Age     &lt;dbl&gt; 1.497884, 11.877010, 5.416991, 4.497799, 5.500789, 2.500972, 6…
```
]

&lt;style&gt;
.panel1-example_read-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-example_read-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-example_read-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---



count: false
 
### Everything working nicely!
.panel1-example_mean-auto[

```r
*paua
```
]
 
.panel2-example_mean-auto[

```
## # A tibble: 60 x 3
##    Species            Length   Age
##    &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;
##  1 Haliotis iris        1.8   1.50
##  2 Haliotis australis   5.4  11.9 
##  3 Haliotis australis   4.8   5.42
##  4 Haliotis iris        5.75  4.50
##  5 Haliotis iris        5.65  5.50
##  6 Haliotis iris        2.8   2.50
##  7 Haliotis australis   5.9   6.49
##  8 Haliotis iris        3.75  5.00
##  9 Haliotis australis   7.2   8.56
## 10 Haliotis iris        4.25  5.50
## # … with 50 more rows
```
]

---
count: false
 
### Everything working nicely!
.panel1-example_mean-auto[

```r
paua %&gt;%
* group_by(Species)
```
]
 
.panel2-example_mean-auto[

```
## # A tibble: 60 x 3
## # Groups:   Species [2]
##    Species            Length   Age
##    &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;
##  1 Haliotis iris        1.8   1.50
##  2 Haliotis australis   5.4  11.9 
##  3 Haliotis australis   4.8   5.42
##  4 Haliotis iris        5.75  4.50
##  5 Haliotis iris        5.65  5.50
##  6 Haliotis iris        2.8   2.50
##  7 Haliotis australis   5.9   6.49
##  8 Haliotis iris        3.75  5.00
##  9 Haliotis australis   7.2   8.56
## 10 Haliotis iris        4.25  5.50
## # … with 50 more rows
```
]

---
count: false
 
### Everything working nicely!
.panel1-example_mean-auto[

```r
paua %&gt;%
  group_by(Species) %&gt;%
* summarise(av_length = mean(Length))
```
]
 
.panel2-example_mean-auto[

```
## # A tibble: 2 x 2
##   Species            av_length
##   &lt;chr&gt;                  &lt;dbl&gt;
## 1 Haliotis australis      5.77
## 2 Haliotis iris           4.81
```
]

&lt;style&gt;
.panel1-example_mean-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-example_mean-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-example_mean-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---


count: false
 
### Everything working nicely!
.panel1-example_plot-auto[

```r
*library(ggplot2)
```
]
 
.panel2-example_plot-auto[

]

---
count: false
 
### Everything working nicely!
.panel1-example_plot-auto[

```r
library(ggplot2)
*ggplot(data = paua,aes(x = Species, y = Length))
```
]
 
.panel2-example_plot-auto[
![](index_files/figure-html/example_plot_auto_02_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
### Everything working nicely!
.panel1-example_plot-auto[

```r
library(ggplot2)
ggplot(data = paua,aes(x = Species, y = Length)) +
* geom_boxplot()
```
]
 
.panel2-example_plot-auto[
![](index_files/figure-html/example_plot_auto_03_output-1.png)&lt;!-- --&gt;
]

---
count: false
 
### Everything working nicely!
.panel1-example_plot-auto[

```r
library(ggplot2)
ggplot(data = paua,aes(x = Species, y = Length)) +
  geom_boxplot()
```
]
 
.panel2-example_plot-auto[
![](index_files/figure-html/example_plot_auto_04_output-1.png)&lt;!-- --&gt;
]

&lt;style&gt;
.panel1-example_plot-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-example_plot-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-example_plot-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;





---

class: inverse, center, middle

# Data exploration and visualization
## Week 2

---
class: inverse


.small[
### Learning objectives
+ **Define** data sovereignty and **explain** this in relation to a researcher's obligation when collecting, displaying, and analysing data
+ **Define** and **discuss** Māori Data Sovereignty principles
+ **Carry out** and **interpret** the outputs of basic exploratory data analysis using in-built R functions
+ **Create** and **communicate** informative data visualisations using `R`
+ **Discuss** and **critique** data visualisations

]

---
### Data Sovereignty?

+ Data Sovereignty typically refers to the understanding that **data is subject to the laws of the nation within which it is stored**

+ Indigenous Data Sovereignty perceives **data as subject to the laws of the nation from which it is collected**

---

### What is Māori Data Sovereignty?

+ Māori Data Sovereignty recognises that **Māori data should be subject to Māori governance**

+ Māori Data Sovereignty **supports tribal sovereignty** and the **realisation of Māori and Iwi aspirations**


---

### Te Mana Raraunga

&lt;iframe src="https://www.temanararaunga.maori.nz/" width="100%" height="400px"&gt;&lt;/iframe&gt;

---

### `tidy` data

 1. Each variable must have its **own column**
 2. Each observation must have its **own row**
 3. Each value must have its **own cell**


&lt;img src="https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/tidydata_1.jpg" width="60%"&gt;

---
### Data manipulation


```r
library(palmerpenguins) ## contains some nice penguin data
penguins %&gt;% 
  apply(.,2,is.na) %&gt;%
  apply(.,2,sum)
```


---
count: false
 
### Data manipulation
.panel1-penguins-auto[

```r
*library(palmerpenguins)  ## contains some nice penguin data
```
]
 
.panel2-penguins-auto[

]

---
count: false
 
### Data manipulation
.panel1-penguins-auto[

```r
library(palmerpenguins)  ## contains some nice penguin data
*penguins
```
]
 
.panel2-penguins-auto[

```
## # A tibble: 344 x 8
##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torgersen           39.1          18.7               181        3750
##  2 Adelie  Torgersen           39.5          17.4               186        3800
##  3 Adelie  Torgersen           40.3          18                 195        3250
##  4 Adelie  Torgersen           NA            NA                  NA          NA
##  5 Adelie  Torgersen           36.7          19.3               193        3450
##  6 Adelie  Torgersen           39.3          20.6               190        3650
##  7 Adelie  Torgersen           38.9          17.8               181        3625
##  8 Adelie  Torgersen           39.2          19.6               195        4675
##  9 Adelie  Torgersen           34.1          18.1               193        3475
## 10 Adelie  Torgersen           42            20.2               190        4250
## # … with 334 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;
```
]

---
count: false
 
### Data manipulation
.panel1-penguins-auto[

```r
library(palmerpenguins)  ## contains some nice penguin data
penguins %&gt;%
* apply(.,2,is.na)
```
]
 
.panel2-penguins-auto[

```
##        species island bill_length_mm bill_depth_mm flipper_length_mm
##   [1,]   FALSE  FALSE          FALSE         FALSE             FALSE
##   [2,]   FALSE  FALSE          FALSE         FALSE             FALSE
##   [3,]   FALSE  FALSE          FALSE         FALSE             FALSE
##   [4,]   FALSE  FALSE           TRUE          TRUE              TRUE
##   [5,]   FALSE  FALSE          FALSE         FALSE             FALSE
##   [6,]   FALSE  FALSE          FALSE         FALSE             FALSE
##   [7,]   FALSE  FALSE          FALSE         FALSE             FALSE
##   [8,]   FALSE  FALSE          FALSE         FALSE             FALSE
##   [9,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [10,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [11,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [12,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [13,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [14,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [15,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [16,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [17,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [18,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [19,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [20,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [21,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [22,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [23,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [24,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [25,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [26,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [27,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [28,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [29,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [30,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [31,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [32,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [33,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [34,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [35,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [36,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [37,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [38,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [39,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [40,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [41,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [42,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [43,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [44,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [45,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [46,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [47,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [48,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [49,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [50,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [51,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [52,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [53,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [54,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [55,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [56,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [57,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [58,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [59,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [60,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [61,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [62,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [63,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [64,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [65,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [66,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [67,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [68,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [69,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [70,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [71,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [72,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [73,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [74,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [75,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [76,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [77,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [78,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [79,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [80,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [81,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [82,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [83,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [84,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [85,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [86,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [87,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [88,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [89,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [90,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [91,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [92,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [93,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [94,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [95,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [96,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [97,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [98,]   FALSE  FALSE          FALSE         FALSE             FALSE
##  [99,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [100,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [101,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [102,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [103,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [104,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [105,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [106,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [107,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [108,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [109,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [110,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [111,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [112,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [113,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [114,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [115,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [116,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [117,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [118,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [119,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [120,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [121,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [122,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [123,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [124,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [125,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [126,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [127,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [128,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [129,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [130,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [131,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [132,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [133,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [134,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [135,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [136,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [137,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [138,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [139,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [140,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [141,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [142,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [143,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [144,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [145,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [146,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [147,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [148,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [149,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [150,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [151,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [152,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [153,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [154,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [155,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [156,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [157,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [158,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [159,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [160,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [161,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [162,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [163,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [164,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [165,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [166,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [167,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [168,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [169,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [170,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [171,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [172,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [173,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [174,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [175,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [176,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [177,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [178,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [179,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [180,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [181,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [182,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [183,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [184,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [185,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [186,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [187,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [188,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [189,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [190,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [191,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [192,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [193,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [194,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [195,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [196,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [197,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [198,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [199,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [200,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [201,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [202,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [203,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [204,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [205,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [206,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [207,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [208,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [209,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [210,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [211,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [212,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [213,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [214,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [215,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [216,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [217,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [218,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [219,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [220,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [221,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [222,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [223,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [224,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [225,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [226,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [227,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [228,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [229,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [230,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [231,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [232,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [233,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [234,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [235,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [236,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [237,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [238,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [239,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [240,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [241,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [242,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [243,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [244,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [245,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [246,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [247,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [248,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [249,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [250,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [251,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [252,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [253,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [254,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [255,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [256,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [257,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [258,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [259,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [260,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [261,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [262,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [263,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [264,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [265,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [266,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [267,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [268,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [269,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [270,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [271,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [272,]   FALSE  FALSE           TRUE          TRUE              TRUE
## [273,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [274,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [275,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [276,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [277,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [278,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [279,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [280,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [281,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [282,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [283,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [284,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [285,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [286,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [287,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [288,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [289,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [290,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [291,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [292,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [293,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [294,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [295,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [296,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [297,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [298,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [299,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [300,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [301,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [302,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [303,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [304,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [305,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [306,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [307,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [308,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [309,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [310,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [311,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [312,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [313,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [314,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [315,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [316,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [317,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [318,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [319,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [320,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [321,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [322,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [323,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [324,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [325,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [326,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [327,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [328,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [329,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [330,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [331,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [332,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [333,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [334,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [335,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [336,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [337,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [338,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [339,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [340,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [341,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [342,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [343,]   FALSE  FALSE          FALSE         FALSE             FALSE
## [344,]   FALSE  FALSE          FALSE         FALSE             FALSE
##        body_mass_g   sex  year
##   [1,]       FALSE FALSE FALSE
##   [2,]       FALSE FALSE FALSE
##   [3,]       FALSE FALSE FALSE
##   [4,]        TRUE  TRUE FALSE
##   [5,]       FALSE FALSE FALSE
##   [6,]       FALSE FALSE FALSE
##   [7,]       FALSE FALSE FALSE
##   [8,]       FALSE FALSE FALSE
##   [9,]       FALSE  TRUE FALSE
##  [10,]       FALSE  TRUE FALSE
##  [11,]       FALSE  TRUE FALSE
##  [12,]       FALSE  TRUE FALSE
##  [13,]       FALSE FALSE FALSE
##  [14,]       FALSE FALSE FALSE
##  [15,]       FALSE FALSE FALSE
##  [16,]       FALSE FALSE FALSE
##  [17,]       FALSE FALSE FALSE
##  [18,]       FALSE FALSE FALSE
##  [19,]       FALSE FALSE FALSE
##  [20,]       FALSE FALSE FALSE
##  [21,]       FALSE FALSE FALSE
##  [22,]       FALSE FALSE FALSE
##  [23,]       FALSE FALSE FALSE
##  [24,]       FALSE FALSE FALSE
##  [25,]       FALSE FALSE FALSE
##  [26,]       FALSE FALSE FALSE
##  [27,]       FALSE FALSE FALSE
##  [28,]       FALSE FALSE FALSE
##  [29,]       FALSE FALSE FALSE
##  [30,]       FALSE FALSE FALSE
##  [31,]       FALSE FALSE FALSE
##  [32,]       FALSE FALSE FALSE
##  [33,]       FALSE FALSE FALSE
##  [34,]       FALSE FALSE FALSE
##  [35,]       FALSE FALSE FALSE
##  [36,]       FALSE FALSE FALSE
##  [37,]       FALSE FALSE FALSE
##  [38,]       FALSE FALSE FALSE
##  [39,]       FALSE FALSE FALSE
##  [40,]       FALSE FALSE FALSE
##  [41,]       FALSE FALSE FALSE
##  [42,]       FALSE FALSE FALSE
##  [43,]       FALSE FALSE FALSE
##  [44,]       FALSE FALSE FALSE
##  [45,]       FALSE FALSE FALSE
##  [46,]       FALSE FALSE FALSE
##  [47,]       FALSE FALSE FALSE
##  [48,]       FALSE  TRUE FALSE
##  [49,]       FALSE FALSE FALSE
##  [50,]       FALSE FALSE FALSE
##  [51,]       FALSE FALSE FALSE
##  [52,]       FALSE FALSE FALSE
##  [53,]       FALSE FALSE FALSE
##  [54,]       FALSE FALSE FALSE
##  [55,]       FALSE FALSE FALSE
##  [56,]       FALSE FALSE FALSE
##  [57,]       FALSE FALSE FALSE
##  [58,]       FALSE FALSE FALSE
##  [59,]       FALSE FALSE FALSE
##  [60,]       FALSE FALSE FALSE
##  [61,]       FALSE FALSE FALSE
##  [62,]       FALSE FALSE FALSE
##  [63,]       FALSE FALSE FALSE
##  [64,]       FALSE FALSE FALSE
##  [65,]       FALSE FALSE FALSE
##  [66,]       FALSE FALSE FALSE
##  [67,]       FALSE FALSE FALSE
##  [68,]       FALSE FALSE FALSE
##  [69,]       FALSE FALSE FALSE
##  [70,]       FALSE FALSE FALSE
##  [71,]       FALSE FALSE FALSE
##  [72,]       FALSE FALSE FALSE
##  [73,]       FALSE FALSE FALSE
##  [74,]       FALSE FALSE FALSE
##  [75,]       FALSE FALSE FALSE
##  [76,]       FALSE FALSE FALSE
##  [77,]       FALSE FALSE FALSE
##  [78,]       FALSE FALSE FALSE
##  [79,]       FALSE FALSE FALSE
##  [80,]       FALSE FALSE FALSE
##  [81,]       FALSE FALSE FALSE
##  [82,]       FALSE FALSE FALSE
##  [83,]       FALSE FALSE FALSE
##  [84,]       FALSE FALSE FALSE
##  [85,]       FALSE FALSE FALSE
##  [86,]       FALSE FALSE FALSE
##  [87,]       FALSE FALSE FALSE
##  [88,]       FALSE FALSE FALSE
##  [89,]       FALSE FALSE FALSE
##  [90,]       FALSE FALSE FALSE
##  [91,]       FALSE FALSE FALSE
##  [92,]       FALSE FALSE FALSE
##  [93,]       FALSE FALSE FALSE
##  [94,]       FALSE FALSE FALSE
##  [95,]       FALSE FALSE FALSE
##  [96,]       FALSE FALSE FALSE
##  [97,]       FALSE FALSE FALSE
##  [98,]       FALSE FALSE FALSE
##  [99,]       FALSE FALSE FALSE
## [100,]       FALSE FALSE FALSE
## [101,]       FALSE FALSE FALSE
## [102,]       FALSE FALSE FALSE
## [103,]       FALSE FALSE FALSE
## [104,]       FALSE FALSE FALSE
## [105,]       FALSE FALSE FALSE
## [106,]       FALSE FALSE FALSE
## [107,]       FALSE FALSE FALSE
## [108,]       FALSE FALSE FALSE
## [109,]       FALSE FALSE FALSE
## [110,]       FALSE FALSE FALSE
## [111,]       FALSE FALSE FALSE
## [112,]       FALSE FALSE FALSE
## [113,]       FALSE FALSE FALSE
## [114,]       FALSE FALSE FALSE
## [115,]       FALSE FALSE FALSE
## [116,]       FALSE FALSE FALSE
## [117,]       FALSE FALSE FALSE
## [118,]       FALSE FALSE FALSE
## [119,]       FALSE FALSE FALSE
## [120,]       FALSE FALSE FALSE
## [121,]       FALSE FALSE FALSE
## [122,]       FALSE FALSE FALSE
## [123,]       FALSE FALSE FALSE
## [124,]       FALSE FALSE FALSE
## [125,]       FALSE FALSE FALSE
## [126,]       FALSE FALSE FALSE
## [127,]       FALSE FALSE FALSE
## [128,]       FALSE FALSE FALSE
## [129,]       FALSE FALSE FALSE
## [130,]       FALSE FALSE FALSE
## [131,]       FALSE FALSE FALSE
## [132,]       FALSE FALSE FALSE
## [133,]       FALSE FALSE FALSE
## [134,]       FALSE FALSE FALSE
## [135,]       FALSE FALSE FALSE
## [136,]       FALSE FALSE FALSE
## [137,]       FALSE FALSE FALSE
## [138,]       FALSE FALSE FALSE
## [139,]       FALSE FALSE FALSE
## [140,]       FALSE FALSE FALSE
## [141,]       FALSE FALSE FALSE
## [142,]       FALSE FALSE FALSE
## [143,]       FALSE FALSE FALSE
## [144,]       FALSE FALSE FALSE
## [145,]       FALSE FALSE FALSE
## [146,]       FALSE FALSE FALSE
## [147,]       FALSE FALSE FALSE
## [148,]       FALSE FALSE FALSE
## [149,]       FALSE FALSE FALSE
## [150,]       FALSE FALSE FALSE
## [151,]       FALSE FALSE FALSE
## [152,]       FALSE FALSE FALSE
## [153,]       FALSE FALSE FALSE
## [154,]       FALSE FALSE FALSE
## [155,]       FALSE FALSE FALSE
## [156,]       FALSE FALSE FALSE
## [157,]       FALSE FALSE FALSE
## [158,]       FALSE FALSE FALSE
## [159,]       FALSE FALSE FALSE
## [160,]       FALSE FALSE FALSE
## [161,]       FALSE FALSE FALSE
## [162,]       FALSE FALSE FALSE
## [163,]       FALSE FALSE FALSE
## [164,]       FALSE FALSE FALSE
## [165,]       FALSE FALSE FALSE
## [166,]       FALSE FALSE FALSE
## [167,]       FALSE FALSE FALSE
## [168,]       FALSE FALSE FALSE
## [169,]       FALSE FALSE FALSE
## [170,]       FALSE FALSE FALSE
## [171,]       FALSE FALSE FALSE
## [172,]       FALSE FALSE FALSE
## [173,]       FALSE FALSE FALSE
## [174,]       FALSE FALSE FALSE
## [175,]       FALSE FALSE FALSE
## [176,]       FALSE FALSE FALSE
## [177,]       FALSE FALSE FALSE
## [178,]       FALSE FALSE FALSE
## [179,]       FALSE  TRUE FALSE
## [180,]       FALSE FALSE FALSE
## [181,]       FALSE FALSE FALSE
## [182,]       FALSE FALSE FALSE
## [183,]       FALSE FALSE FALSE
## [184,]       FALSE FALSE FALSE
## [185,]       FALSE FALSE FALSE
## [186,]       FALSE FALSE FALSE
## [187,]       FALSE FALSE FALSE
## [188,]       FALSE FALSE FALSE
## [189,]       FALSE FALSE FALSE
## [190,]       FALSE FALSE FALSE
## [191,]       FALSE FALSE FALSE
## [192,]       FALSE FALSE FALSE
## [193,]       FALSE FALSE FALSE
## [194,]       FALSE FALSE FALSE
## [195,]       FALSE FALSE FALSE
## [196,]       FALSE FALSE FALSE
## [197,]       FALSE FALSE FALSE
## [198,]       FALSE FALSE FALSE
## [199,]       FALSE FALSE FALSE
## [200,]       FALSE FALSE FALSE
## [201,]       FALSE FALSE FALSE
## [202,]       FALSE FALSE FALSE
## [203,]       FALSE FALSE FALSE
## [204,]       FALSE FALSE FALSE
## [205,]       FALSE FALSE FALSE
## [206,]       FALSE FALSE FALSE
## [207,]       FALSE FALSE FALSE
## [208,]       FALSE FALSE FALSE
## [209,]       FALSE FALSE FALSE
## [210,]       FALSE FALSE FALSE
## [211,]       FALSE FALSE FALSE
## [212,]       FALSE FALSE FALSE
## [213,]       FALSE FALSE FALSE
## [214,]       FALSE FALSE FALSE
## [215,]       FALSE FALSE FALSE
## [216,]       FALSE FALSE FALSE
## [217,]       FALSE FALSE FALSE
## [218,]       FALSE FALSE FALSE
## [219,]       FALSE  TRUE FALSE
## [220,]       FALSE FALSE FALSE
## [221,]       FALSE FALSE FALSE
## [222,]       FALSE FALSE FALSE
## [223,]       FALSE FALSE FALSE
## [224,]       FALSE FALSE FALSE
## [225,]       FALSE FALSE FALSE
## [226,]       FALSE FALSE FALSE
## [227,]       FALSE FALSE FALSE
## [228,]       FALSE FALSE FALSE
## [229,]       FALSE FALSE FALSE
## [230,]       FALSE FALSE FALSE
## [231,]       FALSE FALSE FALSE
## [232,]       FALSE FALSE FALSE
## [233,]       FALSE FALSE FALSE
## [234,]       FALSE FALSE FALSE
## [235,]       FALSE FALSE FALSE
## [236,]       FALSE FALSE FALSE
## [237,]       FALSE FALSE FALSE
## [238,]       FALSE FALSE FALSE
## [239,]       FALSE FALSE FALSE
## [240,]       FALSE FALSE FALSE
## [241,]       FALSE FALSE FALSE
## [242,]       FALSE FALSE FALSE
## [243,]       FALSE FALSE FALSE
## [244,]       FALSE FALSE FALSE
## [245,]       FALSE FALSE FALSE
## [246,]       FALSE FALSE FALSE
## [247,]       FALSE FALSE FALSE
## [248,]       FALSE FALSE FALSE
## [249,]       FALSE FALSE FALSE
## [250,]       FALSE FALSE FALSE
## [251,]       FALSE FALSE FALSE
## [252,]       FALSE FALSE FALSE
## [253,]       FALSE FALSE FALSE
## [254,]       FALSE FALSE FALSE
## [255,]       FALSE FALSE FALSE
## [256,]       FALSE FALSE FALSE
## [257,]       FALSE  TRUE FALSE
## [258,]       FALSE FALSE FALSE
## [259,]       FALSE FALSE FALSE
## [260,]       FALSE FALSE FALSE
## [261,]       FALSE FALSE FALSE
## [262,]       FALSE FALSE FALSE
## [263,]       FALSE FALSE FALSE
## [264,]       FALSE FALSE FALSE
## [265,]       FALSE FALSE FALSE
## [266,]       FALSE FALSE FALSE
## [267,]       FALSE FALSE FALSE
## [268,]       FALSE FALSE FALSE
## [269,]       FALSE  TRUE FALSE
## [270,]       FALSE FALSE FALSE
## [271,]       FALSE FALSE FALSE
## [272,]        TRUE  TRUE FALSE
## [273,]       FALSE FALSE FALSE
## [274,]       FALSE FALSE FALSE
## [275,]       FALSE FALSE FALSE
## [276,]       FALSE FALSE FALSE
## [277,]       FALSE FALSE FALSE
## [278,]       FALSE FALSE FALSE
## [279,]       FALSE FALSE FALSE
## [280,]       FALSE FALSE FALSE
## [281,]       FALSE FALSE FALSE
## [282,]       FALSE FALSE FALSE
## [283,]       FALSE FALSE FALSE
## [284,]       FALSE FALSE FALSE
## [285,]       FALSE FALSE FALSE
## [286,]       FALSE FALSE FALSE
## [287,]       FALSE FALSE FALSE
## [288,]       FALSE FALSE FALSE
## [289,]       FALSE FALSE FALSE
## [290,]       FALSE FALSE FALSE
## [291,]       FALSE FALSE FALSE
## [292,]       FALSE FALSE FALSE
## [293,]       FALSE FALSE FALSE
## [294,]       FALSE FALSE FALSE
## [295,]       FALSE FALSE FALSE
## [296,]       FALSE FALSE FALSE
## [297,]       FALSE FALSE FALSE
## [298,]       FALSE FALSE FALSE
## [299,]       FALSE FALSE FALSE
## [300,]       FALSE FALSE FALSE
## [301,]       FALSE FALSE FALSE
## [302,]       FALSE FALSE FALSE
## [303,]       FALSE FALSE FALSE
## [304,]       FALSE FALSE FALSE
## [305,]       FALSE FALSE FALSE
## [306,]       FALSE FALSE FALSE
## [307,]       FALSE FALSE FALSE
## [308,]       FALSE FALSE FALSE
## [309,]       FALSE FALSE FALSE
## [310,]       FALSE FALSE FALSE
## [311,]       FALSE FALSE FALSE
## [312,]       FALSE FALSE FALSE
## [313,]       FALSE FALSE FALSE
## [314,]       FALSE FALSE FALSE
## [315,]       FALSE FALSE FALSE
## [316,]       FALSE FALSE FALSE
## [317,]       FALSE FALSE FALSE
## [318,]       FALSE FALSE FALSE
## [319,]       FALSE FALSE FALSE
## [320,]       FALSE FALSE FALSE
## [321,]       FALSE FALSE FALSE
## [322,]       FALSE FALSE FALSE
## [323,]       FALSE FALSE FALSE
## [324,]       FALSE FALSE FALSE
## [325,]       FALSE FALSE FALSE
## [326,]       FALSE FALSE FALSE
## [327,]       FALSE FALSE FALSE
## [328,]       FALSE FALSE FALSE
## [329,]       FALSE FALSE FALSE
## [330,]       FALSE FALSE FALSE
## [331,]       FALSE FALSE FALSE
## [332,]       FALSE FALSE FALSE
## [333,]       FALSE FALSE FALSE
## [334,]       FALSE FALSE FALSE
## [335,]       FALSE FALSE FALSE
## [336,]       FALSE FALSE FALSE
## [337,]       FALSE FALSE FALSE
## [338,]       FALSE FALSE FALSE
## [339,]       FALSE FALSE FALSE
## [340,]       FALSE FALSE FALSE
## [341,]       FALSE FALSE FALSE
## [342,]       FALSE FALSE FALSE
## [343,]       FALSE FALSE FALSE
## [344,]       FALSE FALSE FALSE
```
]

---
count: false
 
### Data manipulation
.panel1-penguins-auto[

```r
library(palmerpenguins)  ## contains some nice penguin data
penguins %&gt;%
  apply(.,2,is.na) %&gt;%
* apply(.,2,sum)
```
]
 
.panel2-penguins-auto[

```
##           species            island    bill_length_mm     bill_depth_mm 
##                 0                 0                 2                 2 
## flipper_length_mm       body_mass_g               sex              year 
##                 2                 2                11                 0
```
]

&lt;style&gt;
.panel1-penguins-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-penguins-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-penguins-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---
### Data manipulation


```r
penguins_nafree &lt;- penguins %&gt;% drop_na()
penguins_nafree
```

---

count: false
 
### Data manipulation
.panel1-penguins_na-auto[

```r
*penguins_nafree &lt;- penguins %&gt;% drop_na()
```
]
 
.panel2-penguins_na-auto[

]

---
count: false
 
### Data manipulation
.panel1-penguins_na-auto[

```r
penguins_nafree &lt;- penguins %&gt;% drop_na()
*penguins_nafree
```
]
 
.panel2-penguins_na-auto[

```
## # A tibble: 333 x 8
##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torgersen           39.1          18.7               181        3750
##  2 Adelie  Torgersen           39.5          17.4               186        3800
##  3 Adelie  Torgersen           40.3          18                 195        3250
##  4 Adelie  Torgersen           36.7          19.3               193        3450
##  5 Adelie  Torgersen           39.3          20.6               190        3650
##  6 Adelie  Torgersen           38.9          17.8               181        3625
##  7 Adelie  Torgersen           39.2          19.6               195        4675
##  8 Adelie  Torgersen           41.1          17.6               182        3200
##  9 Adelie  Torgersen           38.6          21.2               191        3800
## 10 Adelie  Torgersen           34.6          21.1               198        4400
## # … with 323 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;
```
]

&lt;style&gt;
.panel1-penguins_na-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-penguins_na-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-penguins_na-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---
### Data manipulation


```r
penguins_nafree %&gt;% 
  group_by(species) %&gt;% 
  summarise(avgerage_bill_length = mean(bill_length_mm))
```

---

count: false
 
### Data manipulation
.panel1-penguins_av-auto[

```r
*penguins_nafree
```
]
 
.panel2-penguins_av-auto[

```
## # A tibble: 333 x 8
##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torgersen           39.1          18.7               181        3750
##  2 Adelie  Torgersen           39.5          17.4               186        3800
##  3 Adelie  Torgersen           40.3          18                 195        3250
##  4 Adelie  Torgersen           36.7          19.3               193        3450
##  5 Adelie  Torgersen           39.3          20.6               190        3650
##  6 Adelie  Torgersen           38.9          17.8               181        3625
##  7 Adelie  Torgersen           39.2          19.6               195        4675
##  8 Adelie  Torgersen           41.1          17.6               182        3200
##  9 Adelie  Torgersen           38.6          21.2               191        3800
## 10 Adelie  Torgersen           34.6          21.1               198        4400
## # … with 323 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;
```
]

---
count: false
 
### Data manipulation
.panel1-penguins_av-auto[

```r
penguins_nafree %&gt;%
* group_by(species)
```
]
 
.panel2-penguins_av-auto[

```
## # A tibble: 333 x 8
## # Groups:   species [3]
##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torgersen           39.1          18.7               181        3750
##  2 Adelie  Torgersen           39.5          17.4               186        3800
##  3 Adelie  Torgersen           40.3          18                 195        3250
##  4 Adelie  Torgersen           36.7          19.3               193        3450
##  5 Adelie  Torgersen           39.3          20.6               190        3650
##  6 Adelie  Torgersen           38.9          17.8               181        3625
##  7 Adelie  Torgersen           39.2          19.6               195        4675
##  8 Adelie  Torgersen           41.1          17.6               182        3200
##  9 Adelie  Torgersen           38.6          21.2               191        3800
## 10 Adelie  Torgersen           34.6          21.1               198        4400
## # … with 323 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;
```
]

---
count: false
 
### Data manipulation
.panel1-penguins_av-auto[

```r
penguins_nafree %&gt;%
  group_by(species) %&gt;%
* summarise(avgerage_bill_length = mean(bill_length_mm))
```
]
 
.panel2-penguins_av-auto[

```
## # A tibble: 3 x 2
##   species   avgerage_bill_length
##   &lt;fct&gt;                    &lt;dbl&gt;
## 1 Adelie                    38.8
## 2 Chinstrap                 48.8
## 3 Gentoo                    47.6
```
]

&lt;style&gt;
.panel1-penguins_av-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-penguins_av-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-penguins_av-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---
class: center, middle

## Data Viz

&gt; "...have obligations in that we have a great deal of power over how people ultimately make use of data, both in the patterns they see and the conclusions they draw." &lt;footer&gt;--- Michael Correll, Ethical Dimensions of Visualization Research&lt;/footer&gt;

---
### Exploratory plots

  + data **exploration**
  + doesn't have to look pretty
  + just needs to **get to the point**
  + **explore** and **discover** new data facets
  + formulate **new questions**
  
---
**[slido.com](slido.com) code #biosci220: what do you think of this plot?**

<div class="countdown" id="timer_605fd702" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">02</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>
  
![](index_files/figure-html/example-1.png)&lt;!-- --&gt;

---

### Explanatory plots
#### most common kind of graph used in scientific publications

   + **clear** purpose
   + designed for the audience
   + make it **easy to read** (*this covers a lot of things*)
   + do not distort
   + guide the reader to a **particular conclusion**
   + answer a **specific question**
   + **support** a decision
   
---

.small[
&gt; "Scientific visualization is classically defined as the process of graphically displaying scientific data ... There are so many different ways to represent the same data: scatter plots, linear plots, bar plots, and pie charts ... the same data, using the same type of plot, may be perceived very differently depending on who is looking at the figure." &lt;footer&gt;--- Nicolas P. Rougier, Michael Droettboom, Philip E. Bourne, Ten Simple Rules for Better Figures &lt;/footer&gt;
]

---

**[slido.com](slido.com) code #biosci220: what do you think of this plot?**

<div class="countdown" id="timer_605fd95f" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">02</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>
  
![](img/coxcomb.png)&lt;!-- --&gt;

.footnote[[Create this yourself](https://rpubs.com/kwlee58/492913)]
---

### [Ten Simple Rules for Better Figures](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003833)

 + **Know** Your Audience
 
 + **Identify** Your Message
 
 + **Adapt** the Figure to the Support Medium
 
 + **Captions** Are Not Optional
 
 + **Do Not** Trust the Defaults
 
---

### [Ten Simple Rules for Better Figures](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003833)

 + Use **Color** Effectively
 
 + **Do Not Mislead** the Reader
    
 + **Avoid** *Chartjunk*
 
 + **Message** Trumps Beauty

 + Get the Right **Tool**


---
### Introducing `ggplot2`

Every `ggplot2` plot has three key components:

  + `data`,

  + A set of `aes`thetic mappings between variables in the data and visual properties, and

  + At least one layer which describes how to render each observation. Layers are usually created with a `geom` function.

---

###  `ggplot2`

&lt;img src = "https://pbs.twimg.com/media/EQ-uBWcX0AIc_bs.png:large"&gt;

---


```r
ggplot(penguins_nafree, aes(x = species, fill = sex)) +
  geom_bar(alpha = 0.8, position = "dodge") +
  facet_wrap(~island) +
  xlab("") +
  theme_linedraw() + 
  scale_fill_manual(values = c("cyan4","darkorange"), name = "Sex") 
```

---

count: false
 

.panel1-bar-auto[

```r
*ggplot(penguins_nafree, aes(x = species, fill = sex))
```
]
 
.panel2-bar-auto[
![](index_files/figure-html/bar_auto_01_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-bar-auto[

```r
ggplot(penguins_nafree, aes(x = species, fill = sex)) +
* geom_bar(alpha = 0.8, position = "dodge")
```
]
 
.panel2-bar-auto[
![](index_files/figure-html/bar_auto_02_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-bar-auto[

```r
ggplot(penguins_nafree, aes(x = species, fill = sex)) +
  geom_bar(alpha = 0.8, position = "dodge") +
* facet_wrap(~island)
```
]
 
.panel2-bar-auto[
![](index_files/figure-html/bar_auto_03_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-bar-auto[

```r
ggplot(penguins_nafree, aes(x = species, fill = sex)) +
  geom_bar(alpha = 0.8, position = "dodge") +
  facet_wrap(~island) +
* xlab("")
```
]
 
.panel2-bar-auto[
![](index_files/figure-html/bar_auto_04_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-bar-auto[

```r
ggplot(penguins_nafree, aes(x = species, fill = sex)) +
  geom_bar(alpha = 0.8, position = "dodge") +
  facet_wrap(~island) +
  xlab("") +
* theme_linedraw()
```
]
 
.panel2-bar-auto[
![](index_files/figure-html/bar_auto_05_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-bar-auto[

```r
ggplot(penguins_nafree, aes(x = species, fill = sex)) +
  geom_bar(alpha = 0.8, position = "dodge") +
  facet_wrap(~island) +
  xlab("") +
  theme_linedraw() +
* scale_fill_manual(values = c("cyan4","darkorange"), name = "Sex")
```
]
 
.panel2-bar-auto[
![](index_files/figure-html/bar_auto_06_output-1.png)&lt;!-- --&gt;
]

&lt;style&gt;
.panel1-bar-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-bar-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-bar-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---



```r
ggplot(data = penguins_nafree, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(color = species),size = 2)  +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4"), name = "") +
  theme_bw() + ## Oo a new theme
  xlab("Bill length (mm)") +
  ylab("Bill length (mm)")
```

---

count: false
 

.panel1-point-auto[

```r
*ggplot(data = penguins_nafree, aes(x = bill_length_mm, y = bill_depth_mm))
```
]
 
.panel2-point-auto[
![](index_files/figure-html/point_auto_01_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-point-auto[

```r
ggplot(data = penguins_nafree, aes(x = bill_length_mm, y = bill_depth_mm)) +
* geom_point(aes(color = species),size = 2)
```
]
 
.panel2-point-auto[
![](index_files/figure-html/point_auto_02_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-point-auto[

```r
ggplot(data = penguins_nafree, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(color = species),size = 2)  +
* scale_color_manual(values = c("darkorange","darkorchid","cyan4"), name = "")
```
]
 
.panel2-point-auto[
![](index_files/figure-html/point_auto_03_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-point-auto[

```r
ggplot(data = penguins_nafree, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(color = species),size = 2)  +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4"), name = "") +
* theme_bw()   ## Oo a new theme
```
]
 
.panel2-point-auto[
![](index_files/figure-html/point_auto_04_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-point-auto[

```r
ggplot(data = penguins_nafree, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(color = species),size = 2)  +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4"), name = "") +
  theme_bw() +  ## Oo a new theme
* xlab("Bill length (mm)")
```
]
 
.panel2-point-auto[
![](index_files/figure-html/point_auto_05_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-point-auto[

```r
ggplot(data = penguins_nafree, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(color = species),size = 2)  +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4"), name = "") +
  theme_bw() +  ## Oo a new theme
  xlab("Bill length (mm)") +
* ylab("Bill length (mm)")
```
]
 
.panel2-point-auto[
![](index_files/figure-html/point_auto_06_output-1.png)&lt;!-- --&gt;
]

&lt;style&gt;
.panel1-point-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-point-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-point-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---
class: center, middle

### **[slido.com](slido.com) code #biosci220: what does a plot tell us about our data?**

<div class="countdown" id="timer_605fd60b" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">02</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
#### Between group variation

![](index_files/figure-html/unnamed-chunk-5-1.png)&lt;!-- --&gt;

---

#### Within group variation

![](index_files/figure-html/unnamed-chunk-6-1.png)&lt;!-- --&gt;

---

class: inverse, center, middle

# Hypothesis testing and introduction to linear regression
## Week 3

---

class: inverse


.small[
### Learning objectives
+ **Formulate** a question/hypothesis to investigate based on the given data
+ **List** the aims, write out the appropriate null and alternative hypothesis using statistical notation for, and write `R` code to carry out a
    + one-sample t-test
    + two-sample t-test (independent and dependent)
    + randomization test
    + one-way Analysis of Variance (ANOVA)
+ Correctly **interpret** and **communicate** a p-value in terms of the hypotheses test listed above

]

---

class: inverse

.small[
### Learning objectives
+ **State** in terms of probability statements the meaning of the power and significance level of an hypothesis test
+ **Explain** and **discuss** the limitations of statistical linear regression, with a single factor explanatory variable
+ **Interpret** and **communicate** the estimated coefficients of a linear regression model with a single factor explanatory variable to both a statistical and non-statistical audience; discuss and critique model fit
 ]
 
---
 
### One-Sample t-test

![](index_files/figure-html/vio1-1.png)&lt;!-- --&gt;

---

How do we reflect our uncertainty about the population mean? 

--

**remember it's the population we want to make inference on based on our sample!**

--

Enter the Standard Error of the Mean, **SEM**,  `\(= \frac{\sigma}{\sqrt{n}}\)`

---

In `R`: 


```r
sem &lt;- paua %&gt;% summarise(mean = mean(Length),
                   sem = sd(Length)/sqrt(length(Length)))
sem
```

```
## # A tibble: 1 x 2
##    mean   sem
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  5.19 0.155
```

---


**Back to our hypothesis test**

**Question:** Do we believe that the average length of Pāua shells is 5cm?

**Formalizing into a hypothesis test:**  

 + *Null hypothesis*: On average Pāua shells are 5cm long
 + *Alternative hypothesis*: On average Pāua shells are **not** 5cm long
 + *Notationally*: `\(H_0: \mu = 5\)` vs `\(H_1: \mu \neq 5\)` ( `\(\mu\)` is the proposed mean)
 
---
 
**Calculating a statistic** (*we use a t-statistic*)

t-statistic `\(= \frac{\bar{x}- \mu}{\text{SEM}}\)` = `\(\frac{5.1925 - 5}{0.155351}\)` = 1.239

   + `\(\bar{x}\)` is the sample mean

   + `\(\mu\)` is the theoretical value (*proposed mean*)
   
   
---

*so great we have a statistic... now what*

--

 😱 p-values 😱
 
--
 
Q: What is a p-Value?

A: Informally, a p-value is the probability under a specified statistical model that a statistical summary of the data would be equal to or more extreme than its observed value

---

In this case it's the probability, under the null hypothesis ( `\(\mu\)` = 5), that we would observe a statistic as least as extreme as we did.

--

The statistic calculated from our hypothesis test was 1.2391. 

--
Remember that our alternative hypotheses was `\(H_1: \mu \neq 5\)` so we have to consider **both sides** of the inequality; hence, anything as least as extreme is either `\(&gt; 1.2391\)` or `\(&lt; -1.2391\)` to our observed statistic.

---
class: inverse

![](index_files/figure-html/unnamed-chunk-7-1.png)&lt;!-- --&gt;

---

#### We can do all of that in one step using `R`:


```r
t.test(paua$Length, mu = 5 )
```

```
## 
## 	One Sample t-test
## 
## data:  paua$Length
## t = 1.2391, df = 59, p-value = 0.2202
## alternative hypothesis: true mean is not equal to 5
## 95 percent confidence interval:
##  4.881643 5.503357
## sample estimates:
## mean of x 
##    5.1925
```

---
class: center, middle

&lt;img src="https://pbs.twimg.com/media/EeMWb7QWsAIGftR?format=jpg&amp;name=small"&gt;

---
class: center, middle

**Question:** Do we believe that on average the length of Pāua shells are equal between species

---
class: center, middle

![](index_files/figure-html/vio-1.png)&lt;!-- --&gt;

---

**Question:** Do we believe that on average the length of Pāua shells are equal between species

**Formalizing into a hypothesis test:**
   
   + **Null hypothesis**: On average the species' shells are the same length
   + **Alternative hypothesis**: they aren't!
   + **Notationally**: `\(H_0: \mu_{\text{Haliotis iris}} - \mu_{\text{Haliotis australis}} = 0\)` vs `\(H_1: \mu_{\text{Haliotis iris}} \neq \mu_{\text{Haliotis australis}}\)`
   

---

**Question:** Do we believe that on average the length of Pāua shells are equal between species

**Calculate the test statistic:** t-statistic = `\(\frac{\bar{x}_{\text{difference}} - \mu}{\text{SED}}\)` = `\(\frac{\bar{x}_{\text{difference}} - 0}{\text{SED}}\)`, where `\(\bar{x}_{\text{difference}}\)` is the differences between the species' averages. 
   
---

**Independent** samples t-test using `t.test()`



```r
test &lt;- t.test(Length ~ Species, data = paua)
## printing out the result
test
```

```
## 
## 	Welch Two Sample t-test
## 
## data:  Length by Species
## t = 3.5404, df = 57.955, p-value = 0.0007957
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.4158802 1.4980086
## sample estimates:
## mean in group Haliotis australis      mean in group Haliotis iris 
##                         5.766667                         4.809722
```

```r
test$p.value
```

```
## [1] 0.0007956853
```

---

**[slido.com](slido.com) code #biosci220**

Listed are the t-statistic, `t` = 3.5403636 and the p-value, `p-value` = 8\times 10^{-4} for the hypothesis test we outlined earlier. 

What would you conclude?


<div class="countdown" id="timer_605fd75a" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">01</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---

#### Independent samples t-test using `lm()`


```r
t.lm &lt;- lm(Length ~ Species, data = paua)
##extracting the estimated parameters
summary(t.lm)$coef
```

```
##                        Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)           5.7666667  0.2278199 25.312396 4.911173e-33
## SpeciesHaliotis iris -0.9569444  0.2941142 -3.253649 1.902460e-03
```

---

**Inference** for `lm()`

(Intercept) = the *baseline* = `\(\mu_\text{Haliotis australis}\)` = 5.7666667

SE of (Intercept) = SE of `\(\mu_\text{Haliotis australis}\)` = SEM = 0.2278199

`\(\text{SpeciesHaliotis iris}\)` = `\(\mu_\text{Haliotis iris}\)` – `\(\mu_\text{Haliotis australis}\)` = -0.9569444

SE of `\(\text{SpeciesHaliotis iris}\)` = SE of ( `\(\mu_\text{Haliotis iris}\)` – `\(\mu_\text{Haliotis australis}\)` ) = SED = 0.2941142

---

**Hypotheses being tested**

+ The `t value` and `Pr (&gt;|t|)` are the t - and p-value for testing the null hypotheses:

	1. Mean abundance is zero for *Haliotis australis* (not interested in this really)
	2. No difference between the population means of *Haliotis australis* and *Haliotis iris*


---

![](index_files/figure-html/unnamed-chunk-8-1.png)&lt;!-- --&gt;

---
#### Randomization tests
*what if we don't want to go parametric*


&lt;img src = "https://i.imgflip.com/2e1aal.jpg"&gt;



---
**Randomization test**


 1. **Decide** on a metric to measure the effect in question (e.g., differences between group means)
 2. **Calculate** that test statistic on the observed data. Note this metric can be **anything** you wish
 3. For chosen number of times (*bigger the better*)
    + **Shuffle** the data labels
    + **Calculate** the test statistic for the reshuffled data and retain
  
---
**Randomization test**

 4. **Calculate** the proportion of times your reshuffled statistics equal or exceed the observed
    + typically here we use the absolute values as we'd be carrying out a **two-tailed** test (or we could double the p-value)
    + this is the probability of such an extreme result under the null
 5. **State** the strength of evidence against the null on the basis of this **probability**.

---

![](index_files/figure-html/unnamed-chunk-9-1.png)&lt;!-- --&gt;

---

##### 😱 Correctly interpreting p-values 😱

+ **p-values** can indicate how incompatible the data are with a specified statistical model

--

+ p-values **do not** measure the probability that the studied hypothesis is true, or the probability that the data were produced by random chance alone

--

+ scientific conclusions and business or policy decisions **should not** be based only on whether a p-value passes a specific threshold

---

##### 😱 Correctly interpreting p-values 😱

+ proper inference requires **full** reporting and transparency

--

+ p-value, or statistical significance, does **not** measure the size of an effect or the importance of a result

--

+ by itself, a p-value does **not** provide a good measure of evidence regarding a model or hypothesis

---

There are **many** different schools of thought about how a p-value should be interpreted.

Most people agree that the p-value is a useful measure of the strength of evidence against the null hypothesis. The smaller the p-value, the stronger the evidence against `\(H_0\)`. 

Some people go further and use an accept/reject framework. Under this framework, the null hypothesis `\(H_0\)` should be rejected if the p-value is less than 0.05 (say), and accepted if the p-value is greater than 0.05.


---
class: middle, center


### Substantial evidence of a difference, **not** Evidence of a substantial difference.



---
**More than two groups** *some terminology*



**Type I** error (false positive): declare a difference (i.e., reject `\(H_0\)`) when there is no difference (i.e. `\(H_0\)` is true). Risk of the Type I error is determined by the **level of significance** (which we set!) (i.e., `\(\alpha =\text{ P(Type I error)} = \text{P(false positive)}\)`.

---

**More than two groups** *some terminology*

**Type II** error (false negative): difference not declared (i.e., `\(H_0\)` not rejected) when there is a difference (i.e., `\(H_0\)` is false). Let `\(\beta =\)` P(do not reject `\(H_0\)` when `\(H_0\)` is false); so, `\(1-\beta\)` = P(reject `\(H_0\)` when `\(H_0\)` is false) = P(a true positive), which is the statistical **power** of the test.

---

**More than two groups** *some terminology*


**Significance level** = probability of a Type I error = probability of finding an effect that is not there (false positive).

**Power**: the probability that the test correctly rejects the null hypothesis when the
alternative hypothesis is true. probability of finding an effect that is there =  1 - probability of a **Type II** error (false negative).


---

**More than two groups** *some terminology*


  + **Effect size** (size of difference, of biological significance) between the true population parameters
  + Experimental error variance 
  + **Sample size**
  + Choice of **Type I** error rate ( `\(\alpha\)` )
  
---
**More than two groups** *some terminology*

Each time we carry out a hypothesis test the probability we get a false positive result (**Type I** error) is given by `\(\alpha\)` (the **level of significance** we choose).

When we have **multiple comparisons** to make we should then control the **Type I** error rate across the entire *family* of tests under consideration, i.e., control the **Family-Wise Error Rate (FWER)**; this ensures that the risk of making at least one **Type I** error among the family of comparisons in the experiment is `\(\alpha\)`.

---
**More than two groups** One way ANOVA using `lm()`

![](index_files/figure-html/unnamed-chunk-10-1.png)&lt;!-- --&gt;

---

**AN**alysis Of **VA**riance (ANOVA): this can, again, be done using `lm()`



```r
fit.lm &lt;- lm(bill_depth_mm ~ species, data = penguins_nafree)
```

*F-test* using `anova()`


```r
## using anova()
anova(fit.lm)
```

```
## Analysis of Variance Table
## 
## Response: bill_depth_mm
##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## species     2 870.79  435.39  344.83 &lt; 2.2e-16 ***
## Residuals 330 416.67    1.26                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---


**Consider the ratio**

`\({\frac  {{\text{variation due to groups}}}{{\text{unexplained variance}}}} = {\frac  {{\text{ mean between-group variability}}}{{\text{mean within-group variability}}}}\)`  `\(=\frac{\text{mean SSB}}{\text{mean SSW}}\)` `\(=\frac{\text{MSB}}{\text{MSW}}\)`  =  `\(\frac{435.3925914}{1.2626477}\)`

This is the **F-statistic**... 

---

Hypothesis: We test the Null hypothesis, `\(H_0\)`, population (species) means are the same on average verses the alternative hypothesis, `\(H_1\)`, that **at least one** differs from the others!

---

Probability of getting an **F-statistic** at least as extreme as the one we observe (think of the area under the tails of the curve below) **p-value** Pr(&gt;F)= 1.4466157\times 10^{-81} tells us we have extremely strong evidence against `\(H_0\)` at the &lt;&lt;0.0001% level of significance

---

*F-test* using `aov()`


```r
## using aov()
aov &lt;- aov(bill_depth_mm ~ species, data = penguins_nafree)
summary(aov)
```

```
##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## species       2  870.8   435.4   344.8 &lt;2e-16 ***
## Residuals   330  416.7     1.3                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

**They are BOTH THE SAME**

---

## **Dummy** variables

$$
`\begin{aligned}
\operatorname{bill\_depth\_mm} &amp;= \alpha\ + \\
&amp;\quad \beta_{1}(\operatorname{species}_{\operatorname{Chinstrap}})\ + \\
&amp;\quad \beta_{2}(\operatorname{species}_{\operatorname{Gentoo}})\ + \\
&amp;\quad \epsilon
\end{aligned}`
$$

<div class="countdown" id="timer_605fd78d" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">02</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>


---
Taking **species** `Adelie` as the **baseline** in linear regression...

 

```r
summary(fit.lm)$coef
```

```
##                     Estimate Std. Error     t value     Pr(&gt;|t|)
## (Intercept)      18.34726027 0.09299608 197.2906740 0.000000e+00
## speciesChinstrap  0.07332796 0.16497460   0.4444803 6.569867e-01
## speciesGentoo    -3.35062162 0.13877592 -24.1441135 6.622121e-75
```

---

(Intercept) = `\(\text{mean}_{\text{Adelie}}\)` = 18.3472603

SE of (Intercept) = SE of `\(\text{mean}_{\text{Adelie}}\)` = SEM = 18.3472603

`\(\text{speciesChinstrap}\)` = `\(\text{mean}_{\text{Chinstrap}}\)` - `\(\text{mean}_{\text{Adelie}}\)` = 0.073328

SE of `\(\text{speciesChinstrap}\)` = SE of ( `\(\text{mean}_{\text{Chinstrap}}\)` - `\(\text{mean}_{\text{Adelie}}\)` ) = SED = 0.1649746

---
**Hypotheses being tested**

+ The `t value` and `Pr (&gt;|t|)` are the t - and p-value for testing the null hypotheses

	1. Mean abundance is zero for Adelie population
	2. No difference between the population means of Chinstrap and Adelie
	3. No difference between the population means of Gentoo and Adelie

We're interested in 2 and 3, but not necessarily 1! What do you conclude? Does your inference match the plot?

---
**Model diagnostics**

Carrying out any linear regression we have some **key assumptions**

+ **Independence** 
+ There is a **linear relationship** between the response and the explanatory variables
+ The residuals have **constant variance**
+ The **residuals** are normally distributed

---
**Diagnostic plots**


```r
gglm::gglm(fit.lm) # Plot the four main diagnostic plots
```

---
**Diagnostic plots**

![](index_files/figure-html/unnamed-chunk-16-1.png)&lt;!-- --&gt;

---

class: inverse, center, middle

# Stats Inference
## Weeks 4 &amp; 5

---
class: inverse

## Key points from last week

+ **Every p-value has a Null Hypothesis**: You cannot interpret a p-value without first establishing the null hypothesis it is testing

--

+ **Variation is the key**: trying our best to explain it really...

---

class: inverse

.small[
## Learning Objectives
+ **Carry out** and **interpret** tests for the existence of relationships between explanatory variables and the response in a linear model
+ **Write** `R` code to fit a linear model with a continuous explanatory variable and a factor explanatory variable
]
---

class: inverse

.small[
## Learning Objectives
   + **Interpret** estimated effects with reference to confidence intervals from linear regression models. Specifically the interpretation of
      + the intercept
      + the effect of a factor
      + the effect of a one-unit increase in a numeric variable
      + the effect of an x-unit increase in a numeric variable
   + **Make** a point prediction of the response for a new observation
  ]
---

class: inverse

.small[
## Learning Objectives
+ **Write** `R` code to fit a linear model with interaction terms in the explanatory variables
+ **Interpret** estimated effects with reference to confidence intervals from linear regression models. Specifically the interpretation of
     + main effects in a model with an interaction
     + the effect of one variable when others are included in the model
  ]
---

class: inverse

.small[
## Learning Objectives
  + **Explain** why you may want to include interaction effects in a linear model
  + **Describe** the differences between the operators `:` and `*` in an `R` model-fitting formula
  ]

---

**Linear regression with a factor explanatory variable**



```r
fit.lm &lt;- lm(bill_depth_mm ~ species, data = penguins_nafree)
summary(fit.lm)$coef
```

```
##                     Estimate Std. Error     t value     Pr(&gt;|t|)
## (Intercept)      18.34726027 0.09299608 197.2906740 0.000000e+00
## speciesChinstrap  0.07332796 0.16497460   0.4444803 6.569867e-01
## speciesGentoo    -3.35062162 0.13877592 -24.1441135 6.622121e-75
```

---
**Linear regression with a factor explanatory variable**

$$
`\begin{aligned}
\operatorname{\widehat{bill\_depth\_mm}} &amp;= 18.35\ + \\
&amp;\quad 0.07(\operatorname{species}_{\operatorname{Chinstrap}})\ - \\
&amp;\quad 3.35(\operatorname{species}_{\operatorname{Gentoo}})
\end{aligned}`
$$


---

![](index_files/figure-html/unnamed-chunk-19-1.png)&lt;!-- --&gt;
---
**Mathematical notation**

`$$Y_i = \alpha + \beta_1x_i + \epsilon_i$$`
where

`$$\epsilon_i \sim \text{Normal}(0,\sigma^2).$$`

--
.small[
Here for observation `\(i\)`

  + `\(Y_i\)` is the value of the **response** 
  + `\(x_i\)` is the value of the **explanatory variable** 
  + `\(\epsilon_i\)` is the **error** term
  + `\(\alpha\)` is the **intercept** term, and 
  + `\(\beta_1\)` is the slope: **coefficient** of the explanatory variable
]
---


First off let's fit a **null** (intercept only)  model. This in *old money* would be called a one sample t-test. 


```r
slm_null &lt;- lm(bill_depth_mm ~ 1, data = penguins_nafree)
summary(slm_null)$coef
```

```
##             Estimate Std. Error  t value      Pr(&gt;|t|)
## (Intercept) 17.16486  0.1079134 159.0614 1.965076e-315
```
---


**Inference**

The `(Intercept)` term, 17.1648649, tells us the (estimated) average value of the response (`bill_depth_mm`), see


```r
penguins_nafree %&gt;% summarise(average_bill_depth = mean(bill_depth_mm))
```

```
## # A tibble: 1 x 1
##   average_bill_depth
##                &lt;dbl&gt;
## 1               17.2
```


---

**`lm()` with a continuous explanatory variable**

![](https://raw.githubusercontent.com/cmjt/statbiscuits/master/figs_n_gifs/lm.gif)
---


**Does `bill_length_mm` help explain some of the variation in `bill_depth_mm`?**

![](index_files/figure-html/unnamed-chunk-21-1.png)&lt;!-- --&gt;
---
**Does `bill_length_mm` help explain some of the variation in `bill_depth_mm`?**


```r
slm &lt;- lm(bill_depth_mm ~ bill_length_mm, data = penguins_nafree)
```

$$
`\begin{aligned}
\operatorname{bill\_depth\_mm} &amp;= \alpha\ + \\
&amp;\quad \beta_{1}(\operatorname{bill\_length\_mm})\ + \\
&amp;\quad \epsilon
\end{aligned}`
$$

---
**Does `bill_length_mm` help explain some of the variation in `bill_depth_mm`?**

```r
summary(slm)$coef
```

```
##                   Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)    20.78664867 0.85417308 24.335406 1.026904e-75
## bill_length_mm -0.08232675 0.01926835 -4.272642 2.528290e-05
```

$$
`\begin{aligned}
\operatorname{\widehat{bill\_depth\_mm}} &amp;= 20.79\ - \\
&amp;\quad 0.08(\operatorname{bill\_length\_mm})
\end{aligned}`
$$

---

Here, the `(Intercept)`: `Estimate`, `\(\alpha\)` above, gives us the estimated average bill depth (mm) **given the estimated relationship** bill length (mm) and bill length.

The `bill_length_mm` : `Estimate`, `\(\beta_1\)` above, is the slope associated with bill length (mm). So, here for every 1mm increase in bill length we estimated a 0.082mm decrease (or a -0.082mm increase) in bill depth.

---

![](index_files/figure-html/unnamed-chunk-24-1.png)&lt;!-- --&gt;


---

**Adding** `species`; remember `species` is a factor variable!

![](index_files/figure-html/unnamed-chunk-25-1.png)&lt;!-- --&gt;

---
**Factor and a continuous variable**


```r
slm_sp &lt;- lm(bill_depth_mm ~ bill_length_mm + species, data = penguins_nafree)
```

$$
`\begin{aligned}
\operatorname{bill\_depth\_mm} &amp;= \alpha\ + \\
&amp;\quad \beta_{1}(\operatorname{bill\_length\_mm})\ + \\
&amp;\quad \beta_{2}(\operatorname{species}_{\operatorname{Chinstrap}})\ + \\
&amp;\quad \beta_{3}(\operatorname{species}_{\operatorname{Gentoo}})\ + \\
&amp;\quad \epsilon
\end{aligned}`
$$
---
**Factor and a continuous variable**


```r
summary(slm_sp)$coef
```

```
##                    Estimate Std. Error    t value     Pr(&gt;|t|)
## (Intercept)      10.5652616 0.69092642  15.291442 2.977289e-40
## bill_length_mm    0.2004431 0.01767974  11.337449 2.258955e-25
## speciesChinstrap -1.9330779 0.22571878  -8.564099 4.259893e-16
## speciesGentoo    -5.1033153 0.19439523 -26.252267 1.043789e-82
```

---
**Factor and a continuous variable**


$$
`\begin{aligned}
\operatorname{\widehat{bill\_depth\_mm}} &amp;= 10.57\ + \\
&amp;\quad 0.2(\operatorname{bill\_length\_mm})\ - \\
&amp;\quad 1.93(\operatorname{species}_{\operatorname{Chinstrap}})\ - \\
&amp;\quad 5.1(\operatorname{species}_{\operatorname{Gentoo}})
\end{aligned}`
$$

---

**Simpson's paradox...** look how the slope associated with bill length (coefficient of `bill_length_mm`) has switched direction from the model above! Why do you think this is?

--

`(Intercept)`: `Estimate` gives us the estimated average bill depth (mm) of the **Adelie** penguins **given the other variables in the model**.

--


`bill_length_mm` : `Estimate`, `\(\beta_1\)` above, is the slope associated with bill length (mm). So, here for every 1mm increase in bill length we estimated a 0.2mm increase in bill depth.

 

---

**The model**
![](index_files/figure-html/unnamed-chunk-30-1.png)&lt;!-- --&gt;

---
**The model**

The *coefficients* for the Gentoo and Chinstrap `species` give the shift (up or down) of the **parallel** lines from the **Adelie** level. So given the estimated relationship between bill depth and bill length these coefficients are the estimated change from the baseline. 
---


**[slido.com](slido.com) code #biosci220: Anything else we might want to try with these variables?**

<div class="countdown" id="timer_605fd84d" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">01</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>
  
---

### Non-parallel lines?


```r
slm_int &lt;- lm(bill_depth_mm ~ bill_length_mm*species, data = penguins_nafree)
summary(slm_int)$coef[,1:2]
```

```
##                                    Estimate Std. Error
## (Intercept)                     11.48770713 1.15987305
## bill_length_mm                   0.17668344 0.02980564
## speciesChinstrap                -3.91856701 2.06730876
## speciesGentoo                   -6.36675118 1.77989710
## bill_length_mm:speciesChinstrap  0.04552828 0.04594283
## bill_length_mm:speciesGentoo     0.03092816 0.04111608
```

---

The **model formula** is

$$
`\begin{aligned}
\operatorname{bill\_depth\_mm} &amp;= \alpha\ + \\
&amp;\quad \beta_{1}(\operatorname{bill\_length\_mm})\ + \\
&amp;\quad \beta_{2}(\operatorname{species}_{\operatorname{Chinstrap}})\ + \\
&amp;\quad \beta_{3}(\operatorname{species}_{\operatorname{Gentoo}})\ + \\
&amp;\quad \beta_{4}(\operatorname{bill\_length\_mm} \times \operatorname{species}_{\operatorname{Chinstrap}})\ + \\
&amp;\quad \beta_{5}(\operatorname{bill\_length\_mm} \times \operatorname{species}_{\operatorname{Gentoo}})\ + \\
&amp;\quad \epsilon
\end{aligned}`
$$
---

The **model formula** is

$$
`\begin{aligned}
\operatorname{\widehat{bill\_depth\_mm}} &amp;= 11.49\ + \\
&amp;\quad 0.18(\operatorname{bill\_length\_mm})\ - \\
&amp;\quad 3.92(\operatorname{species}_{\operatorname{Chinstrap}})\ - \\
&amp;\quad 6.37(\operatorname{species}_{\operatorname{Gentoo}})\ + \\
&amp;\quad 0.05(\operatorname{bill\_length\_mm} \times \operatorname{species}_{\operatorname{Chinstrap}})\ + \\
&amp;\quad 0.03(\operatorname{bill\_length\_mm} \times \operatorname{species}_{\operatorname{Gentoo}})
\end{aligned}`
$$

---


`(Intercept)`: `Estimate` gives us the estimated average bill depth (mm) of the **Adelie** penguins **given the other variables in the model**.

--

`bill_length_mm` : `Estimate`, `\(\beta_1\)` above, is the slope associated with bill length (mm). So, here for every 1mm increase in bill length we estimated a 0.177mm increase in bill depth.

---

class: middle

The main effects of species (i.e., `speciesChinstrap`: `Estimate` and `speciesGentoo`:`Estimate` ) again give the shift (up or down) of the lines from the **Adelie** level; however these lines are no longer parallel! The interaction terms (i.e., `bill_length_mm:speciesChinstrap` and `bill_length_mm:speciesGentoo`) specify the species specific slopes **given the other variables in the model**.

---

![](index_files/figure-html/unnamed-chunk-34-1.png)&lt;!-- --&gt;


---

**[slido.com](slido.com) #biosci220** 

![](index_files/figure-html/unnamed-chunk-35-1.png)&lt;!-- --&gt;

<div class="countdown" id="timer_605fd821" style="top:0;right:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">01</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>
  

---

### Model comparison and selection


We can compare **nested** linear models by hypothesis testing. Luckily the `R` function `anova()` automates this. Yes the same idea as we've previously learnt about ANOVA! We essentially perform an F-ratio test between the nested models! 

--

By **nested** we mean that one model is a subset of the other (i.e., where some coefficients have been fixed at zero).

---
**Does species help us explain some of the variation over bill length alone?** `slm_sp` vs `slm`?



```r
anova(slm,slm_sp)
```

```
## Analysis of Variance Table
## 
## Model 1: bill_depth_mm ~ bill_length_mm
## Model 2: bill_depth_mm ~ bill_length_mm + species
##   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    331 1220.16                                  
## 2    329  299.62  2    920.55 505.41 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---

The `anova()` function takes the two model objects (`slm` and `slm_sp`) each as arguments. It returns an ANOVA testing whether the more complex model (`slm_sp`) is just as good at capturing the variation in the data as the simpler model (`slm`). 
 
--
 
The p-value should be interpreted as the strength of evidence against the null hypothesis of each model being equally good at capturing the variation in the response.

---

**Are the non-parallel lines non-parallel enough to reject the parallel line model?** `slm_int` vs `slm_sp`?


```r
anova(slm_sp,slm_int)
```

```
## Analysis of Variance Table
## 
## Model 1: bill_depth_mm ~ bill_length_mm + species
## Model 2: bill_depth_mm ~ bill_length_mm * species
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1    329 299.62                           
## 2    327 298.62  2   0.99284 0.5436 0.5812
```

--

So it seems both models are just as good at capturing the variation in our data: we're happy with the parallel lines!

---

**model checking again...**

![](index_files/figure-html/unnamed-chunk-38-1.png)&lt;!-- --&gt;

---

**Akaike information criterion** (AIC), another model comparison tool

It is an estimator of prediction error. The AIC provides a means for model selection, which penalizes for model complexity. 

For now the smaller (*by comparison*) the better... (see Nick's section for more)


```r
AIC(slm,slm_sp,slm_int)
```

```
##         df       AIC
## slm      3 1383.4462
## slm_sp   5  919.8347
## slm_int  7  922.7294
```


---

### After all that what do estimated parameters mean?

**Confidence intervals for parameters**

For the *chosen* `slm_sp` model we can get these simply by using 


```r
cis &lt;- confint(slm_sp)
cis
```

```
##                       2.5 %     97.5 %
## (Intercept)       9.2060707 11.9244526
## bill_length_mm    0.1656635  0.2352227
## speciesChinstrap -2.3771120 -1.4890438
## speciesGentoo    -5.4857298 -4.7209009
```
By default the 95% intervals are returned


---

### After all that what do estimated parameters mean?

**Confidence intervals for parameters**

--

So this tells us that For every 1mm increase in bill length we estimate the expected bill depth to increases between 0.166 and 0.235 mm

--

We estimate that the expected bill depth of a Chinstrap penguin is between
1.5 and 2.4 mm shallower than the Adelie penguin

---

## Point prediction

Using the `slm_sp` model we can make a point prediction for the expected bill depth (mm) for Gentoo penguins with a bill length of 50mm:

$$
`\begin{aligned}
\operatorname{bill\_depth\_mm} &amp;= \alpha\ + \\
&amp;\quad \beta_{1}(\operatorname{bill\_length\_mm})\ + \\
&amp;\quad \beta_{2}(\operatorname{species}_{\operatorname{Chinstrap}})\ + \\
&amp;\quad \beta_{3}(\operatorname{species}_{\operatorname{Gentoo}})\ + \\
&amp;\quad \epsilon
\end{aligned}`
$$

---

## Point prediction

Using the `slm_sp` model we can make a point prediction for the expected bill depth (mm) for Gentoo penguins with a bill length of 50mm:

$$
`\begin{aligned}
\operatorname{\widehat{bill\_depth\_mm}} &amp;= 10.57\ + \\
&amp;\quad 0.2(\operatorname{bill\_length\_mm})\ - \\
&amp;\quad 1.93(\operatorname{species}_{\operatorname{Chinstrap}})\ - \\
&amp;\quad 5.1(\operatorname{species}_{\operatorname{Gentoo}})
\end{aligned}`
$$

---

## Point prediction

Using the `slm_sp` model we can make a point prediction for the expected bill depth (mm) for Gentoo penguins with a bill length of 50mm:

`$$\widehat{\text{bill depth}} = \hat{\alpha} + \hat{\beta_1}*50 + \hat{\beta_3}*1$$`
`$$\downarrow$$`

`$$\widehat{\text{bill depth}} = 10.56 + 0.20*50 - 5.10*1$$`
`$$\downarrow$$`

`$$15.47\text{mm}$$`

---

#### Rather than *by hand* we can do this easily in `R`


```r
## create new data frame with data we want to predict to
## the names have to match those in our original data frame
newdata &lt;- data.frame(species = "Gentoo",bill_length_mm = 50)
## use predict() function
predict(slm_sp, newdata = newdata) ## more accurate than our by hand version!
```

```
##       1 
## 15.4841
```
---

![](index_files/figure-html/unnamed-chunk-44-1.png)&lt;!-- --&gt;


---
class: inverse, center, middle

# Introduction to experimental Design
## Week 5

---

class: inverse

.small[
## Learning Objectives

+ **Identify** the following in a given experiment
      + experimental unit
      + observational units
+ **List** and **describe** the three main principals of experimental design:
     + Randomization
     + Replication
     + Blocking
]


---

**Pair &amp; share**

&lt;img src = "img/pirates.svg"&gt;

<div class="countdown" id="timer_605fd66f" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">01</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: inverse, center, middle

&lt;img src="img/gosset.jpg"&gt;

**[William Sealy Gosset](https://en.wikipedia.org/wiki/William_Sealy_Gosset)**
---
class: inverse, center, middle

&gt; To call in the statistician after the experiment is done may be no more than asking him to perform a postmortem examination... he may be able to say what the experiment died of &lt;footer&gt;--- R.A. Fisher, Indian Statistical Congress, Sankhya, ca 1938&lt;/footer&gt;

---

class: inverse, center, middle

&gt; To call in the statistician after the experiment is done may be no more than asking ~~him~~ them to perform a postmortem examination... ~~he~~ they may be able to say what the experiment died of &lt;footer&gt;--- R.A. Fisher, Indian Statistical Congress, Sankhya, ca 1938&lt;/footer&gt;
 
---
class: center, middle

[&lt;img src="img/fisher.png" width="45%"&gt;](https://statmodeling.stat.columbia.edu/2020/08/01/ra-fisher-and-the-science-of-hatred/) &lt;img src = "https://pbs.twimg.com/media/EaTQvJBX0AM2cWC.jpg" width="45%"&gt;


---

##  Key phrases

**Experimental unit** Smallest portion of experimental material which is *independently* perturbed

--
 

**Treatment** The experimental condition *independently* applied to an experimental unit

--


**Observational unit** The smallest unit on which a response is measured. 

---
#### Example

**Biological question** How much herbicide residue is left in a plot of sprayed soil 2 weeks post spraying? We compare 2 herbicides: Weedz and B180. We randomly spray each of 5 plots of weeds with Weedz and the other 5 with B180.

**Treatment** 2 herbicides (levels): Weedz and B180.

**Experimental unit**: Plots

---
#### Example

**Observational unit** changes depending on the scenario.

   + A single core taken from each plot and one measurement per core taken `\(\rightarrow\)` **plot**
   + A single core taken from each plot and 6 subsamples are then taken from each core, measurements per subsample are taken `\(\rightarrow\)` **subsample**
   + 4 cores are taken from each plot and from each core a measurement is taken `\(\rightarrow\)` **core**
   
---
class: inverse

### Three key principles of exprimental design

--

### **Replication**

--

### **Randomisation**

--

### **Blocking**


---

**Replication**

+ **Biological replication:** each treatment is *independently* applied to each of several humans, animals or plants
  + To generalize results to population

---

**Replication**

+ **Technical replication:** two or more samples from the same biological source which are *independently* processed
  + Advantageous if processing steps introduce a lot of variation
  + Increases the precision with which comparisons of relative abundances between treatments are made

---

**Replication**

+ **Pseudo-replication:** one sample from the same biological source, divided into two or more aliquots which are **independently** measured
  + Advantageous for noisy measuring instruments
  + Increases the **precision** with which comparisons of relative abundances between treatments are made
  
---

**Randomization**

+ Protects against bias

--

+ Plan the experiment in such a way that the variations caused by extraneous factors can all be combined under the general heading of "chance".


---

**Randomization**

+ Ensures that each treatment has the same probability of getting good (or bad) units and thus avoids systematic bias

--

+ Random allocation can cancel out population bias; it ensures that any other possible causes for the experimental results are split equally between groups

---

**Randomization**

+ Typically statistical analysis assumes that observations are **independent**. This is almost never strictly true in practice but randomisation means that our estimates will behave as if they were based on independent observations

---

**Blocking**

+ Blocking helps **control variability** by making treatment groups more alike. Experimental units are divided into subsets (called blocks) so that units within the same block are more similar than units from different subsets or blocks. 

--

+ Blocking is a technique for dealing with *nuisance factors*. A *nuisance factor* is a factor that has some effect on the response, but is of no interest (e.g., age class).

---


**Design your own experiment** *virtually*

&lt;iframe src="https://cmjt.shinyapps.io/vested/?showcase=0" width="100%" height="400px"&gt;&lt;/iframe&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "<div class=\"progress-bar-container\">\n  <div class=\"progress-bar\" style=\"width: calc(%current% / %total% * 100%);\">\n  </div>\n</div>"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
